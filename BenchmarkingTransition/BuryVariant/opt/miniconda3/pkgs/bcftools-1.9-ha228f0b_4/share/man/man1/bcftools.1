'\" t
.\"     Title: bcftools
.\"    Author: [see the "AUTHORS" section]
.\" Generator: DocBook XSL Stylesheets v1.76.1 <http://docbook.sf.net/>
.\"      Date: 2018-07-18
.\"    Manual: \ \&
.\"    Source: \ \&
.\"  Language: English
.\"
.TH "BCFTOOLS" "1" "2018\-07\-18" "\ \&" "\ \&"
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
bcftools \- utilities for variant calling and manipulating VCFs and BCFs\&.
.SH "SYNOPSIS"
.sp
\fBbcftools\fR [\-\-version|\-\-version\-only] [\-\-help] [\fICOMMAND\fR] [\fIOPTIONS\fR]
.SH "DESCRIPTION"
.sp
BCFtools is a set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF\&. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF\-compressed\&.
.sp
Most commands accept VCF, bgzipped VCF and BCF with filetype detected automatically even when streaming from a pipe\&. Indexed VCF and BCF will work in all situations\&. Un\-indexed VCF and BCF and streams will work in most, but not all situations\&. In general, whenever multiple VCFs are read simultaneously, they must be indexed and therefore also compressed\&.
.sp
BCFtools is designed to work on a stream\&. It regards an input file "\-" as the standard input (stdin) and outputs to the standard output (stdout)\&. Several commands can thus be combined with Unix pipes\&.
.SS "VERSION"
.sp
This manual page was last updated \fB2018\-07\-18\fR and refers to bcftools git version \fB1\&.9\fR\&.
.SS "BCF1"
.sp
The BCF1 format output by versions of samtools <= 0\&.1\&.19 is \fBnot\fR compatible with this version of bcftools\&. To read BCF1 files one can use the view command from old versions of bcftools packaged with samtools versions <= 0\&.1\&.19 to convert to VCF, which can then be read by this version of bcftools\&.
.sp
.if n \{\
.RS 4
.\}
.nf
    samtools\-0\&.1\&.19/bcftools/bcftools view file\&.bcf1 | bcftools view
.fi
.if n \{\
.RE
.\}
.SS "VARIANT CALLING"
.sp
See \fIbcftools call\fR for variant calling from the output of the \fIsamtools mpileup\fR command\&. In versions of samtools <= 0\&.1\&.19 calling was done with \fIbcftools view\fR\&. Users are now required to choose between the old samtools calling model (\fI\-c/\-\-consensus\-caller\fR) and the new multiallelic calling model (\fI\-m/\-\-multiallelic\-caller\fR)\&. The multiallelic calling model is recommended for most tasks\&.
.SH "LIST OF COMMANDS"
.sp
For a full list of available commands, run \fBbcftools\fR without arguments\&. For a full list of available options, run \fBbcftools\fR \fICOMMAND\fR without arguments\&.
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBannotate\fR
\&.\&. edit VCF files, add or remove annotations
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBcall\fR
\&.\&. SNP/indel calling (former "view")
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBcnv\fR
\&.\&. Copy Number Variation caller
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBconcat\fR
\&.\&. concatenate VCF/BCF files from the same set of samples
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBconsensus\fR
\&.\&. create consensus sequence by applying VCF variants
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBconvert\fR
\&.\&. convert VCF/BCF to other formats and back
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBcsq\fR
\&.\&. haplotype aware consequence caller
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBfilter\fR
\&.\&. filter VCF/BCF files using fixed thresholds
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBgtcheck\fR
\&.\&. check sample concordance, detect sample swaps and contamination
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBindex\fR
\&.\&. index VCF/BCF
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBisec\fR
\&.\&. intersections of VCF/BCF files
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBmerge\fR
\&.\&. merge VCF/BCF files files from non\-overlapping sample sets
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBmpileup\fR
\&.\&. multi\-way pileup producing genotype likelihoods
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBnorm\fR
\&.\&. normalize indels
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBplugin\fR
\&.\&. run user\-defined plugin
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBpolysomy\fR
\&.\&. detect contaminations and whole\-chromosome aberrations
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBquery\fR
\&.\&. transform VCF/BCF into user\-defined formats
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBreheader\fR
\&.\&. modify VCF/BCF header, change sample names
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBroh\fR
\&.\&. identify runs of homo/auto\-zygosity
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBsort\fR
\&.\&. sort VCF/BCF files
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBstats\fR
\&.\&. produce VCF/BCF stats (former vcfcheck)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBview\fR
\&.\&. subset, filter and convert VCF and BCF files
.RE
.SH "LIST OF SCRIPTS"
.sp
Some helper scripts are bundled with the bcftools code\&.
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBplot\-vcfstats\fR
\&.\&. plots the output of
\fBstats\fR
.RE
.SH "COMMANDS AND OPTIONS"
.SS "Common Options"
.sp
The following options are common to many bcftools commands\&. See usage for specific commands to see if they apply\&.
.PP
\fIFILE\fR
.RS 4
Files can be both VCF or BCF, uncompressed or BGZF\-compressed\&. The file "\-" is interpreted as standard input\&. Some tools may require tabix\- or CSI\-indexed files\&.
.RE
.PP
\fB\-c, \-\-collapse\fR \fIsnps\fR|\fIindels\fR|\fIboth\fR|\fIall\fR|\fIsome\fR|\fInone\fR|\fIid\fR
.RS 4
Controls how to treat records with duplicate positions and defines compatible records across multiple input files\&. Here by "compatible" we mean records which should be considered as identical by the tools\&. For example, when performing line intersections, the desire may be to consider as identical all sites with matching positions (\fBbcftools isec \-c\fR
\fIall\fR), or only sites with matching variant type (\fBbcftools isec \-c\fR
\fIsnps\fR\ \&
\fB\-c\fR
\fIindels\fR), or only sites with all alleles identical (\fBbcftools isec \-c\fR
\fInone\fR)\&.
.PP
\fInone\fR
.RS 4
only records with identical REF and ALT alleles are compatible
.RE
.PP
\fIsome\fR
.RS 4
only records where some subset of ALT alleles match are compatible
.RE
.PP
\fIall\fR
.RS 4
all records are compatible, regardless of whether the ALT alleles match or not\&. In the case of records with the same position, only the first will be considered and appear on output\&.
.RE
.PP
\fIsnps\fR
.RS 4
any SNP records are compatible, regardless of whether the ALT alleles match or not\&. For duplicate positions, only the first SNP record will be considered and appear on output\&.
.RE
.PP
\fIindels\fR
.RS 4
all indel records are compatible, regardless of whether the REF and ALT alleles match or not\&. For duplicate positions, only the first indel record will be considered and appear on output\&.
.RE
.PP
\fIboth\fR
.RS 4
abbreviation of "\fB\-c\fR
\fIindels\fR\ \&
\fB\-c\fR
\fIsnps\fR"
.RE
.PP
\fIid\fR
.RS 4
only records with identical ID column are compatible\&. Supported by
\fBbcftools merge\fR
only\&.
.RE
.RE
.PP
\fB\-f, \-\-apply\-filters\fR \fILIST\fR
.RS 4
Skip sites where FILTER column does not contain any of the strings listed in
\fILIST\fR\&. For example, to include only sites which have no filters set, use
\fB\-f\fR
\fI\&.,PASS\fR\&.
.RE
.PP
\fB\-\-no\-version\fR
.RS 4
Do not append version and command line information to the output VCF header\&.
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
When output consists of a single stream, write it to
\fIFILE\fR
rather than to standard output, where it is written by default\&.
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
Output compressed BCF (\fIb\fR), uncompressed BCF (\fIu\fR), compressed VCF (\fIz\fR), uncompressed VCF (\fIv\fR)\&. Use the \-Ou option when piping between bcftools subcommands to speed up performance by removing unnecessary compression/decompression and VCF←→BCF conversion\&.
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
Comma\-separated list of regions, see also
\fB\-R, \-\-regions\-file\fR\&. Note that
\fB\-r\fR
cannot be used in combination with
\fB\-R\fR\&.
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIFILE\fR
.RS 4
Regions can be specified either on command line or in a VCF, BED, or tab\-delimited file (the default)\&. The columns of the tab\-delimited file are: CHROM, POS, and, optionally, POS_TO, where positions are 1\-based and inclusive\&. The columns of the tab\-delimited BED file are also CHROM, POS and POS_TO (trailing columns are ignored), but coordinates are 0\-based, half\-open\&. To indicate that a file be treated as BED rather than the 1\-based tab\-delimited file, the file must have the "\&.bed" or "\&.bed\&.gz" suffix (case\-insensitive)\&. Uncompressed files are stored in memory, while bgzip\-compressed and tabix\-indexed region files are streamed\&. Note that sequence names must match exactly, "chr20" is not the same as "20"\&. Also note that chromosome ordering in
\fIFILE\fR
will be respected, the VCF will be processed in the order in which chromosomes first appear in
\fIFILE\fR\&. However, within chromosomes, the VCF will always be processed in ascending genomic coordinate order no matter what order they appear in
\fIFILE\fR\&. Note that overlapping regions in
\fIFILE\fR
can result in duplicated out of order positions in the output\&. This option requires indexed VCF/BCF files\&. Note that
\fB\-R\fR
cannot be used in combination with
\fB\-r\fR\&.
.RE
.PP
\fB\-s, \-\-samples\fR [^]\fILIST\fR
.RS 4
Comma\-separated list of samples to include or exclude if prefixed with "^"\&. The sample order is updated to reflect that given on the command line\&. Note that in general tags such as INFO/AC, INFO/AN, etc are not updated to correspond to the subset samples\&.
\fBbcftools view\fR
is the exception where some tags will be updated (unless the
\fB\-I, \-\-no\-update\fR
option is used; see
\fBbcftools view\fR
documentation)\&. To use updated tags for the subset in another command one can pipe from
\fBview\fR
into that command\&. For example:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools view \-Ou \-s sample1,sample2 file\&.vcf | bcftools query \-f %INFO/AC\et%INFO/AN\en
.fi
.if n \{\
.RE
.\}
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
File of sample names to include or exclude if prefixed with "^"\&. One sample per line\&. See also the note above for the
\fB\-s, \-\-samples\fR
option\&. The sample order is updated to reflect that given in the input file\&. The command
\fBbcftools call\fR
accepts an optional second column indicating ploidy (0, 1 or 2) or sex (as defined by
\fB\-\-ploidy\fR, for example "F" or "M"), and can parse also PED files\&. If the second column is not present, the sex "F" is assumed\&. With
\fBbcftools call\fR\fB \-C\fR
\fItrio\fR, PED file is expected\&. File formats examples:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    sample1    1
    sample2    2
    sample3    2

  or

    sample1    M
    sample2    F
    sample3    F

  or a \&.ped file (here is shown a minimum working example, the first column is
  ignored and the last indicates sex: 1=male, 2=female)

    ignored daughterA fatherA motherA 2
    ignored sonB fatherB motherB 1
.fi
.if n \{\
.RE
.\}
.PP
\fB\-t, \-\-targets\fR [^]\fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
Similar as
\fB\-r, \-\-regions\fR, but the next position is accessed by streaming the whole VCF/BCF rather than using the tbi/csi index\&. Both
\fB\-r\fR
and
\fB\-t\fR
options can be applied simultaneously:
\fB\-r\fR
uses the index to jump to a region and
\fB\-t\fR
discards positions which are not in the targets\&. Unlike
\fB\-r\fR, targets can be prefixed with "^" to request logical complement\&. For example, "^X,Y,MT" indicates that sequences X, Y and MT should be skipped\&. Yet another difference between the two is that
\fB\-r\fR
checks both start and end positions of indels, whereas
\fB\-t\fR
checks start positions only\&. Note that
\fB\-t\fR
cannot be used in combination with
\fB\-T\fR\&.
.RE
.PP
\fB\-T, \-\-targets\-file\fR [^]\fIFILE\fR
.RS 4
Same
\fB\-t, \-\-targets\fR, but reads regions from a file\&. Note that
\fB\-T\fR
cannot be used in combination with
\fB\-t\fR\&.
.RE
.PP
.RS 4
With the
\fBcall \-C\fR
\fIalleles\fR
command, third column of the targets file must be comma\-separated list of alleles, starting with the reference allele\&. Note that the file must be compressed and index\&. Such a file can be easily created from a VCF using:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools query \-f\*(Aq%CHROM\et%POS\et%REF,%ALT\en\*(Aq file\&.vcf | bgzip \-c > als\&.tsv\&.gz && tabix \-s1 \-b2 \-e2 als\&.tsv\&.gz
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
Number of output compression threads to use in addition to main thread\&. Only used when
\fI\-\-output\-type\fR
is
\fIb\fR
or
\fIz\fR\&. Default: 0\&.
.RE
.SS "bcftools annotate \fI[OPTIONS]\fR \fIFILE\fR"
.sp
Add or remove annotations\&.
.PP
\fB\-a, \-\-annotations\fR \fIfile\fR
.RS 4
Bgzip\-compressed and tabix\-indexed file with annotations\&. The file can be VCF, BED, or a tab\-delimited file with mandatory columns CHROM, POS (or, alternatively, FROM and TO), optional columns REF and ALT, and arbitrary number of annotation columns\&. BED files are expected to have the "\&.bed" or "\&.bed\&.gz" suffix (case\-insensitive), otherwise a tab\-delimited file is assumed\&. Note that in case of tab\-delimited file, the coordinates POS, FROM and TO are one\-based and inclusive\&. When REF and ALT are present, only matching VCF records will be annotated\&. When multiple ALT alleles are present in the annotation file (given as comma\-separated list of alleles), at least one must match one of the alleles in the corresponding VCF record\&. Similarly, at least one alternate allele from a multi\-allelic VCF record must be present in the annotation file\&. Note that flag types, such as "INFO/FLAG", can be annotated by including a field with the value "1" to set the flag, "0" to remove it, or "\&." to keep existing flags\&. See also
\fB\-c, \-\-columns\fR
and
\fB\-h, \-\-header\-lines\fR\&.
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    # Sample annotation file with columns CHROM, POS, STRING_TAG, NUMERIC_TAG
    1  752566  SomeString      5
    1  798959  SomeOtherString 6
    # etc\&.
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-collapse\fR \fIsnps\fR|\fIindels\fR|\fIboth\fR|\fIall\fR|\fIsome\fR|\fInone\fR
.RS 4
Controls how to match records from the annotation file to the target VCF\&. Effective only when
\fB\-a\fR
is a VCF or BCF\&. See
\fBCommon Options\fR
for more\&.
.RE
.PP
\fB\-c, \-\-columns\fR \fIlist\fR
.RS 4
Comma\-separated list of columns or tags to carry over from the annotation file (see also
\fB\-a, \-\-annotations\fR)\&. If the annotation file is not a VCF/BCF,
\fIlist\fR
describes the columns of the annotation file and must include CHROM, POS (or, alternatively, FROM and TO), and optionally REF and ALT\&. Unused columns which should be ignored can be indicated by "\-"\&.

If the annotation file is a VCF/BCF, only the edited columns/tags must be present and their order does not matter\&. The columns ID, QUAL, FILTER, INFO and FORMAT can be edited, where INFO tags can be written both as "INFO/TAG" or simply "TAG", and FORMAT tags can be written as "FORMAT/TAG" or "FMT/TAG"\&. The imported VCF annotations can be renamed as "DST_TAG:=SRC_TAG" or "FMT/DST_TAG:=FMT/SRC_TAG"\&.

To carry over all INFO annotations, use "INFO"\&. To add all INFO annotations except "TAG", use "^INFO/TAG"\&. By default, existing values are replaced\&.

To add annotations without overwriting existing values (that is, to add missing tags or add values to existing tags with missing values), use "+TAG" instead of "TAG"\&. To append to existing values (rather than replacing or leaving untouched), use "=TAG" (instead of "TAG" or "+TAG")\&. To replace only existing values without modifying missing annotations, use "\-TAG"\&.

If the annotation file is not a VCF/BCF, all new annotations must be defined via
\fB\-h, \-\-header\-lines\fR\&.
.RE
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-h, \-\-header\-lines\fR \fIfile\fR
.RS 4
Lines to append to the VCF header, see also
\fB\-c, \-\-columns\fR
and
\fB\-a, \-\-annotations\fR\&. For example:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    ##INFO=<ID=NUMERIC_TAG,Number=1,Type=Integer,Description="Example header line">
    ##INFO=<ID=STRING_TAG,Number=1,Type=String,Description="Yet another header line">
.fi
.if n \{\
.RE
.\}
.PP
\fB\-I, \-\-set\-id\fR [+]\fIFORMAT\fR
.RS 4
assign ID on the fly\&. The format is the same as in the
\fBquery\fR
command (see below)\&. By default all existing IDs are replaced\&. If the format string is preceded by "+", only missing IDs will be set\&. For example, one can use
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools annotate \-\-set\-id +\*(Aq%CHROM\e_%POS\e_%REF\e_%FIRST_ALT\*(Aq file\&.vcf
.fi
.if n \{\
.RE
.\}
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-k, \-\-keep\-sites\fR
.RS 4
keep sites wich do not pass
\fB\-i\fR
and
\fB\-e\fR
expressions instead of discarding them
.RE
.PP
\fB\-m, \-\-mark\-sites\fR \fITAG\fR
.RS 4
annotate sites which are present ("+") or absent ("\-") in the
\fB\-a\fR
file with a new INFO/TAG flag
.RE
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-rename\-chrs\fR \fIfile\fR
.RS 4
rename chromosomes according to the map in
\fIfile\fR, with "old_name new_name\en" pairs separated by whitespaces, each on a separate line\&.
.RE
.PP
\fB\-s, \-\-samples\fR [^]\fILIST\fR
.RS 4
subset of samples to annotate, see also
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
subset of samples to annotate\&. If the samples are named differently in the target VCF and the
\fB\-a, \-\-annotations\fR
VCF, the name mapping can be given as "src_name dst_name\en", separated by whitespaces, each pair on a separate line\&.
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-x, \-\-remove\fR \fIlist\fR
.RS 4
List of annotations to remove\&. Use "FILTER" to remove all filters or "FILTER/SomeFilter" to remove a specific filter\&. Similarly, "INFO" can be used to remove all INFO tags and "FORMAT" to remove all FORMAT tags except GT\&. To remove all INFO tags except "FOO" and "BAR", use "^INFO/FOO,INFO/BAR" (and similarly for FORMAT and FILTER)\&. "INFO" can be abbreviated to "INF" and "FORMAT" to "FMT"\&.
.RE
.sp
\fBExamples:\fR
.sp
.if n \{\
.RS 4
.\}
.nf
    # Remove three fields
    bcftools annotate \-x ID,INFO/DP,FORMAT/DP file\&.vcf\&.gz

    # Remove all INFO fields and all FORMAT fields except for GT and PL
    bcftools annotate \-x INFO,^FORMAT/GT,FORMAT/PL file\&.vcf

    # Add ID, QUAL and INFO/TAG, not replacing TAG if already present
    bcftools annotate \-a src\&.bcf \-c ID,QUAL,+TAG dst\&.bcf

    # Carry over all INFO and FORMAT annotations except FORMAT/GT
    bcftools annotate \-a src\&.bcf \-c INFO,^FORMAT/GT dst\&.bcf

    # Annotate from a tab\-delimited file with six columns (the fifth is ignored),
    # first indexing with tabix\&. The coordinates are 1\-based\&.
    tabix \-s1 \-b2 \-e2 annots\&.tab\&.gz
    bcftools annotate \-a annots\&.tab\&.gz \-h annots\&.hdr \-c CHROM,POS,REF,ALT,\-,TAG file\&.vcf

    # Annotate from a tab\-delimited file with regions (1\-based coordinates, inclusive)
    tabix \-s1 \-b2 \-e3 annots\&.tab\&.gz
    bcftools annotate \-a annots\&.tab\&.gz \-h annots\&.hdr \-c CHROM,FROM,TO,TAG inut\&.vcf

    # Annotate from a bed file (0\-based coordinates, half\-closed, half\-open intervals)
    bcftools annotate \-a annots\&.bed\&.gz \-h annots\&.hdr \-c CHROM,FROM,TO,TAG input\&.vcf
.fi
.if n \{\
.RE
.\}
.SS "bcftools call \fI[OPTIONS]\fR \fIFILE\fR"
.sp
This command replaces the former \fBbcftools view\fR caller\&. Some of the original functionality has been temporarily lost in the process of transition under htslib, but will be added back on popular demand\&. The original calling model can be invoked with the \fB\-c\fR option\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBFile format options:\fR
.RS 4
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-ploidy\fR \fIASSEMBLY\fR[\fI?\fR]
.RS 4
predefined ploidy, use
\fIlist\fR
(or any other unused word) to print a list of all predefined assemblies\&. Append a question mark to print the actual definition\&. See also
\fB\-\-ploidy\-file\fR\&.
.RE
.PP
\fB\-\-ploidy\-file\fR \fIFILE\fR
.RS 4
ploidy definition given as a space/tab\-delimited list of CHROM, FROM, TO, SEX, PLOIDY\&. The SEX codes are arbitrary and correspond to the ones used by
\fB\-\-samples\-file\fR\&. The default ploidy can be given using the starred records (see below), unlisted regions have ploidy 2\&. The default ploidy definition is
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    X 1 60000 M 1
    X 2699521 154931043 M 1
    Y 1 59373566 M 1
    Y 1 59373566 F 0
    MT 1 16569 M 1
    MT 1 16569 F 1
    *  * *     M 2
    *  * *     F 2
.fi
.if n \{\
.RE
.\}
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBInput/output options:\fR
.RS 4
.PP
\fB\-A, \-\-keep\-alts\fR
.RS 4
output all alternate alleles present in the alignments even if they do not appear in any of the genotypes
.RE
.PP
\fB\-f, \-\-format\-fields\fR \fIlist\fR
.RS 4
comma\-separated list of FORMAT fields to output for each sample\&. Currently GQ and GP fields are supported\&. For convenience, the fields can be given as lower case letters\&.
.RE
.PP
\fB\-F, \-\-prior\-freqs\fR \fIAN\fR,\fIAC\fR
.RS 4
take advantage of prior knowledge of population allele frequencies\&. The workflow looks like this:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    # Extract AN,AC values from an existing VCF, such 1000Genomes
    bcftools query \-f\*(Aq%CHROM\et%POS\et%REF\et%ALT\et%AN\et%AC\en\*(Aq 1000Genomes\&.bcf | bgzip \-c > AFs\&.tab\&.gz

    # If the tags AN,AC are not already present, use the +fill\-AN\-AC plugin
    bcftools +fill\-AN\-AC 1000Genomes\&.bcf | bcftools query \-f\*(Aq%CHROM\et%POS\et%REF\et%ALT\et%AN\et%AC\en\*(Aq | bgzip \-c > AFs\&.tab\&.gz
    tabix \-s1 \-b2 \-e2 AFs\&.tab\&.gz

    # Create a VCF header description, here we name the tags REF_AN,REF_AC
    cat AFs\&.hdr
    ##INFO=<ID=REF_AN,Number=1,Type=Integer,Description="Total number of alleles in reference genotypes">
    ##INFO=<ID=REF_AC,Number=A,Type=Integer,Description="Allele count in reference genotypes for each ALT allele">

    # Now before calling, stream the raw mpileup output through `bcftools annotate` to add the frequencies
    bcftools mpileup [\&.\&.\&.] \-Ou | bcftools annotate \-a AFs\&.tab\&.gz \-h AFs\&.hdr \-c CHROM,POS,REF,ALT,REF_AN,REF_AC \-Ou | bcftools call \-mv \-F REF_AN,REF_AC [\&.\&.\&.]
.fi
.if n \{\
.RE
.\}
.PP
\fB\-g, \-\-gvcf\fR \fIINT\fR
.RS 4
output also gVCF blocks of homozygous REF calls\&. The parameter
\fIINT\fR
is the minimum per\-sample depth required to include a site in the non\-variant block\&.
.RE
.PP
\fB\-i, \-\-insert\-missed\fR \fIINT\fR
.RS 4
output also sites missed by mpileup but present in
\fB\-T, \-\-targets\-file\fR\&.
.RE
.PP
\fB\-M, \-\-keep\-masked\-ref\fR
.RS 4
output sites where REF allele is N
.RE
.PP
\fB\-V, \-\-skip\-variants\fR \fIsnps\fR|\fIindels\fR
.RS 4
skip indel/SNP sites
.RE
.PP
\fB\-v, \-\-variants\-only\fR
.RS 4
output variant sites only
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBConsensus/variant calling options:\fR
.RS 4
.PP
\fB\-c, \-\-consensus\-caller\fR
.RS 4
the original
\fBsamtools\fR/\fBbcftools\fR
calling method (conflicts with
\fB\-m\fR)
.RE
.PP
\fB\-C, \-\-constrain\fR \fIalleles\fR|\fItrio\fR
.RS 4
.PP
\fIalleles\fR
.RS 4
call genotypes given alleles\&. See also
\fB\-T, \-\-targets\-file\fR\&.
.RE
.PP
\fItrio\fR
.RS 4
call genotypes given the father\-mother\-child constraint\&. See also
\fB\-s, \-\-samples\fR
and
\fB\-n, \-\-novel\-rate\fR\&.
.RE
.RE
.PP
\fB\-m, \-\-multiallelic\-caller\fR
.RS 4
alternative modelfor multiallelic and rare\-variant calling designed to overcome known limitations in
\fB\-c\fR
calling model (conflicts with
\fB\-c\fR)
.RE
.PP
\fB\-n, \-\-novel\-rate\fR \fIfloat\fR[,\&...]
.RS 4
likelihood of novel mutation for constrained
\fB\-C\fR
\fItrio\fR
calling\&. The trio genotype calling maximizes likelihood of a particular combination of genotypes for father, mother and the child P(F=i,M=j,C=k) = P(unconstrained) * Pn + P(constrained) * (1\-Pn)\&. By providing three values, the mutation rate Pn is set explicitly for SNPs, deletions and insertions, respectively\&. If two values are given, the first is interpreted as the mutation rate of SNPs and the second is used to calculate the mutation rate of indels according to their length as Pn=\fIfloat\fR*exp(\-a\-b*len), where a=22\&.8689, b=0\&.2994 for insertions and a=21\&.9313, b=0\&.2856 for deletions [pubmed:23975140]\&. If only one value is given, the same mutation rate Pn is used for SNPs and indels\&.
.RE
.PP
\fB\-p, \-\-pval\-threshold\fR \fIfloat\fR
.RS 4
with
\fB\-c\fR, accept variant if P(ref|D) <
\fIfloat\fR\&.
.RE
.PP
\fB\-P, \-\-prior\fR \fIfloat\fR
.RS 4
expected substitution rate, or 0 to disable the prior\&. Only with
\fB\-m\fR\&.
.RE
.PP
\fB\-t, \-\-targets\fR \fIfile\fR|\fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-X, \-\-chromosome\-X\fR
.RS 4
haploid output for male samples (requires PED file with
\fB\-s\fR)
.RE
.PP
\fB\-Y, \-\-chromosome\-Y\fR
.RS 4
haploid output for males and skips females (requires PED file with
\fB\-s\fR)
.RE
.RE
.SS "bcftools cnv \fI[OPTIONS]\fR \fIFILE\fR"
.sp
Copy number variation caller, requires a VCF annotated with the Illumina\(cqs B\-allele frequency (BAF) and Log R Ratio intensity (LRR) values\&. The HMM considers the following copy number states: CN 2 (normal), 1 (single\-copy loss), 0 (complete loss), 3 (single\-copy gain)\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBGeneral Options:\fR
.RS 4
.PP
\fB\-c, \-\-control\-sample\fR \fIstring\fR
.RS 4
optional control sample name\&. If given, pairwise calling is performed and the
\fB\-P\fR
option can be used
.RE
.PP
\fB\-f, \-\-AF\-file\fR \fIfile\fR
.RS 4
read allele frequencies from a tab\-delimited file with the columns CHR,POS,REF,ALT,AF
.RE
.PP
\fB\-o, \-\-output\-dir\fR \fIpath\fR
.RS 4
output directory
.RE
.PP
\fB\-p, \-\-plot\-threshold\fR \fIfloat\fR
.RS 4
call
\fBmatplotlib\fR
to produce plots for chromosomes with quality at least
\fIfloat\fR, useful for visual inspection of the calls\&. With
\fB\-p 0\fR, plots for all chromosomes will be generated\&. If not given, a
\fBmatplotlib\fR
script will be created but not called\&.
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-query\-sample\fR \fIstring\fR
.RS 4
query samply name
.RE
.PP
\fB\-t, \-\-targets\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBHMM Options:\fR
.RS 4
.PP
\fB\-a, \-\-aberrant\fR \fIfloat\fR[,\fIfloat\fR]
.RS 4
fraction of aberrant cells in query and control\&. The hallmark of duplications and contaminations is the BAF value of heterozygous markers which is dependent on the fraction of aberrant cells\&. Sensitivity to smaller fractions of cells can be increased by setting
\fB\-a\fR
to a lower value\&. Note however, that this comes at the cost of increased false discovery rate\&.
.RE
.PP
\fB\-b, \-\-BAF\-weight\fR \fIfloat\fR
.RS 4
relative contribution from BAF
.RE
.PP
\fB\-d, \-\-BAF\-dev\fR \fIfloat\fR[,\fIfloat\fR]
.RS 4
expected BAF deviation in query and control, i\&.e\&. the noise observed in the data\&.
.RE
.PP
\fB\-e, \-\-err\-prob\fR \fIfloat\fR
.RS 4
uniform error probability
.RE
.PP
\fB\-l, \-\-LRR\-weight\fR \fIfloat\fR
.RS 4
relative contribution from LRR\&. With noisy data, this option can have big effect on the number of calls produced\&. In truly random noise (such as in simulated data), the value should be set high (1\&.0), but in the presence of systematic noise when LRR are not informative, lower values result in cleaner calls (0\&.2)\&.
.RE
.PP
\fB\-L, \-\-LRR\-smooth\-win\fR \fIint\fR
.RS 4
reduce LRR noise by applying moving average given this window size
.RE
.PP
\fB\-O, \-\-optimize\fR \fIfloat\fR
.RS 4
iteratively estimate the fraction of aberrant cells, down to the given fraction\&. Lowering this value from the default 1\&.0 to say, 0\&.3, can help discover more events but also increases noise
.RE
.PP
\fB\-P, \-\-same\-prob\fR \fIfloat\fR
.RS 4
the prior probability of the query and the control sample being the same\&. Setting to 0 calls both independently, setting to 1 forces the same copy number state in both\&.
.RE
.PP
\fB\-x, \-\-xy\-prob\fR \fIfloat\fR
.RS 4
the HMM probability of transition to another copy number state\&. Increasing this values leads to smaller and more frequent calls\&.
.RE
.RE
.SS "bcftools concat \fI[OPTIONS]\fR \fIFILE1\fR \fIFILE2\fR [\&...]"
.sp
Concatenate or combine VCF/BCF files\&. All source files must have the same sample columns appearing in the same order\&. Can be used, for example, to concatenate chromosome VCFs into one VCF, or combine a SNP VCF and an indel VCF into one\&. The input files must be sorted by chr and position\&. The files must be given in the correct order to produce sorted VCF on output unless the \fB\-a, \-\-allow\-overlaps\fR option is specified\&. With the \-\-naive option, the files are concatenated without being recompressed, which is very fast but dangerous if the BCF headers differ\&.
.PP
\fB\-a, \-\-allow\-overlaps\fR
.RS 4
First coordinate of the next file can precede last record of the current file\&.
.RE
.PP
\fB\-c, \-\-compact\-PS\fR
.RS 4
Do not output PS tag at each site, only at the start of a new phase set block\&.
.RE
.PP
\fB\-d, \-\-rm\-dups\fR \fIsnps\fR|\fIindels\fR|\fIboth\fR|\fIall\fR|\fInone\fR
.RS 4
Output duplicate records of specified type present in multiple files only once\&. Requires
\fB\-a, \-\-allow\-overlaps\fR\&.
.RE
.PP
\fB\-D, \-\-remove\-duplicates\fR
.RS 4
Alias for
\fB\-d none\fR
.RE
.PP
\fB\-f, \-\-file\-list\fR \fIFILE\fR
.RS 4
Read file names from
\fIFILE\fR, one file name per line\&.
.RE
.PP
\fB\-l, \-\-ligate\fR
.RS 4
Ligate phased VCFs by matching phase at overlapping haplotypes
.RE
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-n, \-\-naive\fR
.RS 4
Concatenate VCF or BCF files without recompression\&. This is very fast but requires that all files are of the same type (all VCF or all BCF) and have the same headers\&. This is because all tags and chromosome names in the BCF body rely on the implicit order of the contig and tag definitions in the header\&. Currently no sanity checks are in place\&. Dangerous, use with caution\&.
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-q, \-\-min\-PQ\fR \fIINT\fR
.RS 4
Break phase set if phasing quality is lower than
\fIINT\fR
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR\&. Requires
\fB\-a, \-\-allow\-overlaps\fR\&.
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR\&. Requires
\fB\-a, \-\-allow\-overlaps\fR\&.
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.SS "bcftools consensus \fI[OPTIONS]\fR \fIFILE\fR"
.sp
Create consensus sequence by applying VCF variants to a reference fasta file\&. By default, the program will apply all ALT variants to the reference fasta to obtain the consensus sequence\&. Using the \fB\-\-sample\fR (and, optionally, \fB\-\-haplotype\fR) option will apply genotype (haplotype) calls from FORMAT/GT\&. Note that the program does not act as a primitive variant caller and ignores allelic depth information, such as INFO/AD or FORMAT/AD\&. For that, consider using the \fBsetGT\fR plugin\&.
.PP
\fB\-c, \-\-chain\fR \fIFILE\fR
.RS 4
write a chain file for liftover
.RE
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-f, \-\-fasta\-ref\fR \fIFILE\fR
.RS 4
reference sequence in fasta format
.RE
.PP
\fB\-H, \-\-haplotype\fR \fI1\fR|\fI2\fR|\fIR\fR|\fIA\fR|\fILR\fR|\fILA\fR|\fISR\fR|\fISA\fR
.RS 4
choose which allele from the FORMAT/GT field to use (the codes are case\-insensitive):
.PP
\fI1\fR
.RS 4
the first allele
.RE
.PP
\fI2\fR
.RS 4
the second allele
.RE
.PP
\fIR\fR
.RS 4
the REF allele (in heterozygous genotypes)
.RE
.PP
\fIA\fR
.RS 4
the ALT allele (in heterozygous genotypes)
.RE
.PP
\fILR, LA\fR
.RS 4
the longer allele\&. If both have the same length, use the REF allele (LR), or the ALT allele (LA)
.RE
.PP
\fISR, SA\fR
.RS 4
the shorter allele\&. If both have the same length, use the REF allele (SR), or the ALT allele (SA)
.sp
.if n \{\
.RS 4
.\}
.nf
This option requires *\-s*, unless exactly one sample is present in the VCF
.fi
.if n \{\
.RE
.\}
.RE
.RE
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-I, \-\-iupac\-codes\fR
.RS 4
output variants in the form of IUPAC ambiguity codes
.RE
.PP
\fB\-m, \-\-mask\fR \fIFILE\fR
.RS 4
BED file or TAB file with regions to be replaced with N\&. See discussion of
\fB\-\-regions\-file\fR
in
\fBCommon Options\fR
for file format details\&.
.RE
.PP
\fB\-M, \-\-missing\fR \fICHAR\fR
.RS 4
instead of skipping the missing genotypes, output the character CHAR (e\&.g\&. "?")
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
write output to a file
.RE
.PP
\fB\-s, \-\-sample\fR \fINAME\fR
.RS 4
apply variants of the given sample
.RE
.sp
\fBExamples:\fR
.sp
.if n \{\
.RS 4
.\}
.nf
    # Apply variants present in sample "NA001", output IUPAC codes for hets
    bcftools consensus \-i \-s NA001 \-f in\&.fa in\&.vcf\&.gz > out\&.fa

    # Create consensus for one region\&. The fasta header lines are then expected
    # in the form ">chr:from\-to"\&.
    samtools faidx ref\&.fa 8:11870\-11890 | bcftools consensus in\&.vcf\&.gz \-o out\&.fa
.fi
.if n \{\
.RE
.\}
.SS "bcftools convert \fI[OPTIONS]\fR \fIFILE\fR"
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBVCF input options:\fR
.RS 4
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBVCF output options:\fR
.RS 4
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBGEN/SAMPLE conversion:\fR
.RS 4
.PP
\fB\-G, \-\-gensample2vcf\fR \fIprefix\fR or \fIgen\-file\fR,\fIsample\-file\fR
.RS 4
convert IMPUTE2 output to VCF\&. The second column must be of the form "CHROM:POS_REF_ALT" to detect possible strand swaps; IMPUTE2 leaves the first one empty ("\-\-") when sites from reference panel are filled in\&. See also
\fB\-g\fR
below\&.
.RE
.PP
\fB\-g, \-\-gensample\fR \fIprefix\fR or \fIgen\-file\fR,\fIsample\-file\fR
.RS 4
convert from VCF to gen/sample format used by IMPUTE2 and SHAPEIT\&. The columns of \&.gen file format are ID1,ID2,POS,A,B followed by three genotype probabilities P(AA), P(AB), P(BB) for each sample\&. In order to prevent strand swaps, the program uses IDs of the form "CHROM:POS_REF_ALT"\&. For example:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
  \&.gen
  \-\-\-\-
  1:111485207_G_A 1:111485207_G_A 111485207 G A 0 1 0 0 1 0
  1:111494194_C_T 1:111494194_C_T 111494194 C T 0 1 0 0 0 1

  \&.sample
  \-\-\-\-\-\-\-
  ID_1 ID_2 missing
  0 0 0
  sample1 sample1 0
  sample2 sample2 0
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-tag\fR \fISTRING\fR
.RS 4
tag to take values for \&.gen file: GT,PL,GL,GP
.RE
.PP
\fB\-\-chrom\fR
.RS 4
output chromosome in the first column instead of CHROM:POS_REF_ALT
.RE
.PP
\fB\-\-sex\fR \fIFILE\fR
.RS 4
output sex column in the sample file\&. The FILE format is
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    MaleSample    M
    FemaleSample  F
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-vcf\-ids\fR
.RS 4
output VCF IDs in the second column instead of CHROM:POS_REF_ALT
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBgVCF conversion:\fR
.RS 4
.PP
\fB\-\-gvcf2vcf\fR
.RS 4
convert gVCF to VCF, expanding REF blocks into sites\&. Note that the
\fB\-i\fR
and
\fB\-e\fR
options work differently with this switch\&. In this situation the filtering expressions define which sites should be expanded and which sites should be left unmodified, but all sites are printed on output\&. In order to drop sites, stream first through
\fBbcftools view\fR\&.
.RE
.PP
\fB\-f, \-\-fasta\-ref\fR \fIfile\fR
.RS 4
reference sequence in fasta format\&. Must be indexed with samtools faidx
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBHAP/SAMPLE conversion:\fR
.RS 4
.PP
\fB\-\-hapsample2vcf\fR \fIprefix\fR or \fIhap\-file\fR,\fIsample\-file\fR
.RS 4
convert from hap/sample format to VCF\&. The columns of \&.hap file are similar to \&.gen file above, but there are only two haplotype columns per sample\&. Note that the first column of the \&.hap file is expected to be in the form "CHR:POS_REF_ALT(_END)?", with the _END being optional for defining the INFO/END tag when ALT is a symbolic allele, for example:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
  \&.hap
  \-\-\-\-
  1:111485207_G_A rsID1 111485207 G A 0 1 0 0
  1:111494194_C_T rsID2 111494194 C T 0 1 0 0
  1:111495231_A_<DEL>_111495784 rsID3 111495231 A <DEL> 0 0 1 0
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-hapsample\fR \fIprefix\fR or \fIhap\-file\fR,\fIsample\-file\fR
.RS 4
convert from VCF to hap/sample format used by IMPUTE2 and SHAPEIT\&. The columns of \&.hap file begin with ID,RSID,POS,REF,ALT\&. In order to prevent strand swaps, the program uses IDs of the form "CHROM:POS_REF_ALT"\&.
.RE
.PP
\fB\-\-haploid2diploid\fR
.RS 4
with
\fB\-h\fR
option converts haploid genotypes to homozygous diploid genotypes\&. For example, the program will print
\fI0 0\fR
instead of the default
\fI0 \-\fR\&. This is useful for programs which do not handle haploid genotypes correctly\&.
.RE
.PP
\fB\-\-sex\fR \fIFILE\fR
.RS 4
output sex column in the sample file\&. The FILE format is
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    MaleSample    M
    FemaleSample  F
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-vcf\-ids\fR
.RS 4
output VCF IDs instead of "CHROM:POS_REF_ALT" IDs
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBHAP/LEGEND/SAMPLE conversion:\fR
.RS 4
.PP
\fB\-H, \-\-haplegendsample2vcf\fR \fIprefix\fR or \fIhap\-file\fR,\fIlegend\-file\fR,\fIsample\-file\fR
.RS 4
convert from hap/legend/sample format used by IMPUTE2 to VCF, see also
\fB\-h, \-\-hapslegendsample\fR
below\&.
.RE
.PP
\fB\-h, \-\-haplegendsample\fR \fIprefix\fR or \fIhap\-file\fR,\fIlegend\-file\fR,\fIsample\-file\fR
.RS 4
convert from VCF to hap/legend/sample format used by IMPUTE2 and SHAPEIT\&. The columns of \&.legend file ID,POS,REF,ALT\&. In order to prevent strand swaps, the program uses IDs of the form "CHROM:POS_REF_ALT"\&. The \&.sample file is quite basic at the moment with columns for population, group and sex expected to be edited by the user\&. For example:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
  \&.hap
  \-\-\-\-\-
  0 1 0 0 1 0
  0 1 0 0 0 1

  \&.legend
  \-\-\-\-\-\-\-
  id position a0 a1
  1:111485207_G_A 111485207 G A
  1:111494194_C_T 111494194 C T

  \&.sample
  \-\-\-\-\-\-\-
  sample population group sex
  sample1 sample1 sample1 2
  sample2 sample2 sample2 2
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-haploid2diploid\fR
.RS 4
with
\fB\-h\fR
option converts haploid genotypes to homozygous diploid genotypes\&. For example, the program will print
\fI0 0\fR
instead of the default
\fI0 \-\fR\&. This is useful for programs which do not handle haploid genotypes correctly\&.
.RE
.PP
\fB\-\-sex\fR \fIFILE\fR
.RS 4
output sex column in the sample file\&. The FILE format is
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    MaleSample    M
    FemaleSample  F
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-vcf\-ids\fR
.RS 4
output VCF IDs instead of "CHROM:POS_REF_ALT" IDs
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBTSV conversion:\fR
.RS 4
.PP
\fB\-\-tsv2vcf\fR \fIfile\fR
.RS 4
convert from TSV (tab\-separated values) format (such as generated by 23andMe) to VCF\&. The input file fields can be tab\- or space\- delimited
.RE
.PP
\fB\-c, \-\-columns\fR \fIlist\fR
.RS 4
comma\-separated list of fields in the input file\&. In the current version, the fields CHROM, POS, ID, and AA are expected and can appear in arbitrary order, columns which should be ignored in the input file can be indicated by "\-"\&. The AA field lists alleles on the forward reference strand, for example "CC" or "CT" for diploid genotypes or "C" for haploid genotypes (sex chromosomes)\&. Insertions and deletions are not supported yet, missing data can be indicated with "\-\-"\&.
.RE
.PP
\fB\-f, \-\-fasta\-ref\fR \fIfile\fR
.RS 4
reference sequence in fasta format\&. Must be indexed with samtools faidx
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
list of sample names\&. See
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
file of sample names\&. See
\fBCommon Options\fR
.RE
.sp
\fBExample:\fR
.sp
.if n \{\
.RS 4
.\}
.nf
# Convert 23andme results into VCF
bcftools convert \-c ID,CHROM,POS,AA \-s SampleName \-f 23andme\-ref\&.fa \-\-tsv2vcf 23andme\&.txt \-Oz \-o out\&.vcf\&.gz
.fi
.if n \{\
.RE
.\}
.RE
.SS "bcftools csq \fI[OPTIONS]\fR \fIFILE\fR"
.sp
Haplotype aware consequence predictor which correctly handles combined variants such as MNPs split over multiple VCF records, SNPs separated by an intron (but adjacent in the spliced transcript) or nearby frame\-shifting indels which in combination in fact are not frame\-shifting\&.
.sp
The output VCF is annotated with INFO/BCSQ and FORMAT/BCSQ tag (configurable with the \fB\-c\fR option)\&. The latter is a bitmask of indexes to INFO/BCSQ, with interleaved haplotypes\&. See the usage examples below for using the %TBCSQ converter in \fBquery\fR for extracting a more human readable form from this bitmask\&. The contruction of the bitmask limits the number of consequences that can be referenced in the FORMAT/BCSQ tags\&. By default this is 16, but if more are required, see the \fB\-\-ncsq\fR option\&.
.sp
The program requires on input a VCF/BCF file, the reference genome in fasta format (\fB\-\-fasta\-ref\fR) and genomic features in the GFF3 format downloadable from the Ensembl website (\fB\-\-gff\-annot\fR), and outputs an annotated VCF/BCF file\&. Currently, only Ensembl GFF3 files are supported\&.
.sp
By default, the input VCF should be phased\&. If phase is unknown, or only partially known, the \fB\-\-phase\fR option can be used to indicate how to handle unphased data\&. Alternatively, haplotype aware calling can be turned off with the \fB\-\-local\-csq\fR option\&.
.sp
If conflicting (overlapping) variants within one haplotype are detected, a warning will be emitted and predictions will be based on only the first variant in the analysis\&.
.sp
Symbolic alleles are not supported\&. They will remain unannotated in the output VCF and are ignored for the prediction analysis\&.
.PP
\fB\-c, \-\-custom\-tag\fR \fISTRING\fR
.RS 4
use this custom tag to store consequences rather than the default BCSQ tag
.RE
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-f, \-\-fasta\-ref\fR \fIFILE\fR
.RS 4
reference sequence in fasta format (required)
.RE
.PP
\fB\-\-force\fR
.RS 4
run even if some sanity checks fail\&. Currently the option allows to skip transcripts in malformatted GFFs with incorrect phase
.RE
.PP
\fB\-g, \-\-gff\-annot\fR \fIFILE\fR
.RS 4
GFF3 annotation file (required), such as
ftp://ftp\&.ensembl\&.org/pub/current_gff3/homo_sapiens\&. An example of a minimal working GFF file:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    # The program looks for "CDS", "exon", "three_prime_UTR" and "five_prime_UTR" lines,
    # looks up their parent transcript (determined from the "Parent=transcript:" attribute),
    # the gene (determined from the transcript\*(Aqs "Parent=gene:" attribute), and the biotype
    # (the most interesting is "protein_coding")\&.
    #
    # Attributes required for
    #   gene lines:
    #   \- ID=gene:<gene_id>
    #   \- biotype=<biotype>
    #   \- Name=<gene_name>      [optional]
    #
    #   transcript lines:
    #   \- ID=transcript:<transcript_id>
    #   \- Parent=gene:<gene_id>
    #   \- biotype=<biotype>
    #
    #   other lines (CDS, exon, five_prime_UTR, three_prime_UTR):
    #   \- Parent=transcript:<transcript_id>
    #
    # Supported biotypes:
    #   \- see the function gff_parse_biotype() in bcftools/csq\&.c

    1   ignored_field  gene            21  2148  \&.   \-   \&.   ID=gene:GeneId;biotype=protein_coding;Name=GeneName
    1   ignored_field  transcript      21  2148  \&.   \-   \&.   ID=transcript:TranscriptId;Parent=gene:GeneId;biotype=protein_coding
    1   ignored_field  three_prime_UTR 21  2054  \&.   \-   \&.   Parent=transcript:TranscriptId
    1   ignored_field  exon            21  2148  \&.   \-   \&.   Parent=transcript:TranscriptId
    1   ignored_field  CDS             21  2148  \&.   \-   1   Parent=transcript:TranscriptId
    1   ignored_field  five_prime_UTR  210 2148  \&.   \-   \&.   Parent=transcript:TranscriptId
.fi
.if n \{\
.RE
.\}
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-l, \-\-local\-csq\fR
.RS 4
switch off haplotype\-aware calling, run localized predictions considering only one VCF record at a time
.RE
.PP
\fB\-n, \-\-ncsq\fR \fIINT\fR
.RS 4
maximum number of consequences to consider per site\&. The INFO/BCSQ column includes all consequences, but only the first
\fIINT\fR
will be referenced by the FORMAT/BCSQ fields\&. The default value is 16 which corresponds to one integer per diploid sample\&. Note that increasing the value leads to increased memory and is rarely necessary\&.
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIt\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR\&. In addition, a custom tab\-delimited plain text output can be printed (\fIt\fR)\&.
.RE
.PP
\fB\-p, \-\-phase\fR \fIa\fR|\fIm\fR|\fIr\fR|\fIR\fR|\fIs\fR
.RS 4
how to handle unphased heterozygous genotypes:
.PP
\fIa\fR
.RS 4
take GTs as is, create haplotypes regardless of phase (0/1 → 0|1)
.RE
.PP
\fIm\fR
.RS 4
merge all GTs into a single haplotype (0/1 → 1, 1/2 → 1)
.RE
.PP
\fIr\fR
.RS 4
require phased GTs, throw an error on unphased heterozygous GTs
.RE
.PP
\fIR\fR
.RS 4
create non\-reference haplotypes if possible (0/1 → 1|1, 1/2 → 1|2)
.RE
.PP
\fIs\fR
.RS 4
skip unphased heterozygous GTs
.RE
.RE
.PP
\fB\-q, \-\-quiet\fR
.RS 4
suppress warning messages
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
samples to include or "\-" to apply all variants and ignore samples
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.sp
\fBExamples:\fR
.sp
.if n \{\
.RS 4
.\}
.nf
    # Basic usage
    bcftools csq \-f hs37d5\&.fa \-g Homo_sapiens\&.GRCh37\&.82\&.gff3\&.gz in\&.vcf \-Ob \-o out\&.bcf

    # Extract the translated haplotype consequences\&. The following TBCSQ variations
    # are recognised:
    #   %TBCSQ    \&.\&. print consequences in all haplotypes in separate columns
    #   %TBCSQ{0} \&.\&. print the first haplotype only
    #   %TBCSQ{1} \&.\&. print the second haplotype only
    #   %TBCSQ{*} \&.\&. print a list of unique consquences present in either haplotype
    bcftools query \-f\*(Aq[%CHROM\et%POS\et%SAMPLE\et%TBCSQ\en]\*(Aq out\&.bcf
.fi
.if n \{\
.RE
.\}
.sp
\fBExamples of BCSQ annotation:\fR
.sp
.if n \{\
.RS 4
.\}
.nf
    # Two separate VCF records at positions 2:122106101 and 2:122106102
    # change the same codon\&. This UV\-induced C>T dinucleotide mutation
    # has been annotated fully at the position 2:122106101 with
    #   \- consequence type
    #   \- gene name
    #   \- ensembl transcript ID
    #   \- coding strand (+ fwd, \- rev)
    #   \- amino acid position (in the coding strand orientation)
    #   \- list of corresponding VCF variants
    # The annotation at the second position gives the position of the full
    # annotation
    BCSQ=missense|CLASP1|ENST00000545861|\-|1174P>1174L|122106101G>A+122106102G>A
    BCSQ=@122106101

    # A frame\-restoring combination of two frameshift insertions C>CG and T>TGG
    BCSQ=@46115084
    BCSQ=inframe_insertion|COPZ2|ENST00000006101|\-|18AGRGP>18AQAGGP|46115072C>CG+46115084T>TGG

    # Stop gained variant
    BCSQ=stop_gained|C2orf83|ENST00000264387|\-|141W>141*|228476140C>T

    # The consequence type of a variant downstream from a stop are prefixed with *
    BCSQ=*missense|PER3|ENST00000361923|+|1028M>1028T|7890117T>C
.fi
.if n \{\
.RE
.\}
.SS "bcftools filter \fI[OPTIONS]\fR \fIFILE\fR"
.sp
Apply fixed\-threshold filters\&.
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-g, \-\-SnpGap\fR \fIINT\fR
.RS 4
filter SNPs within
\fIINT\fR
base pairs of an indel\&. The following example demonstrates the logic of
\fB\-\-SnpGap\fR
\fI3\fR
applied on a deletion and an insertion:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
The SNPs at positions 1 and 7 are filtered, positions 0 and 8 are not:
         0123456789
    ref  \&.G\&.GT\&.\&.G\&.\&.
    del  \&.A\&.G\-\&.\&.A\&.\&.
Here the positions 1 and 6 are filtered, 0 and 7 are not:
         0123\-456789
    ref  \&.G\&.G\-\&.\&.G\&.\&.
    ins  \&.A\&.GT\&.\&.A\&.\&.
.fi
.if n \{\
.RE
.\}
.PP
\fB\-G, \-\-IndelGap\fR \fIINT\fR
.RS 4
filter clusters of indels separated by
\fIINT\fR
or fewer base pairs allowing only one to pass\&. The following example demonstrates the logic of
\fB\-\-IndelGap\fR
\fI2\fR
applied on a deletion and an insertion:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
The second indel is filtered:
         012345678901
    ref  \&.GT\&.GT\&.\&.GT\&.\&.
    del  \&.G\-\&.G\-\&.\&.G\-\&.\&.
And similarly here, the second is filtered:
         01 23 456 78
    ref  \&.A\-\&.A\-\&.\&.A\-\&.\&.
    ins  \&.AT\&.AT\&.\&.AT\&.\&.
.fi
.if n \{\
.RE
.\}
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-m, \-\-mode\fR [\fI+x\fR]
.RS 4
define behaviour at sites with existing FILTER annotations\&. The default mode replaces existing filters of failed sites with a new FILTER string while leaving sites which pass untouched when non\-empty and setting to "PASS" when the FILTER string is absent\&. The "+" mode appends new FILTER strings of failed sites instead of replacing them\&. The "x" mode resets filters of sites which pass to "PASS"\&. Modes "+" and "x" can both be set\&.
.RE
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-soft\-filter\fR \fISTRING\fR|\fI+\fR
.RS 4
annotate FILTER column with
\fISTRING\fR
or, with
\fI+\fR, a unique filter name generated by the program ("Filter%d")\&.
.RE
.PP
\fB\-S, \-\-set\-GTs\fR \fI\&.\fR|\fI0\fR
.RS 4
set genotypes of failed samples to missing value (\fI\&.\fR) or reference allele (\fI0\fR)
.RE
.PP
\fB\-t, \-\-targets\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.SS "bcftools gtcheck [\fIOPTIONS\fR] [\-g \fIgenotypes\&.vcf\&.gz\fR] \fIquery\&.vcf\&.gz\fR"
.sp
Checks sample identity\&. The program can operate in two modes\&. If the \fB\-g\fR option is given, the identity of the \fB\-s\fR sample from \fIquery\&.vcf\&.gz\fR is checked against the samples in the \fB\-g\fR file\&. Without the \fB\-g\fR option, multi\-sample cross\-check of samples in \fIquery\&.vcf\&.gz\fR is performed\&.
.PP
\fB\-a, \-\-all\-sites\fR
.RS 4
output for all sites
.RE
.PP
\fB\-c, \-\-cluster\fR \fIFLOAT\fR,\fIFLOAT\fR
.RS 4
min inter\- and max intra\-sample error [0\&.23,\-0\&.3]
.sp
.if n \{\
.RS 4
.\}
.nf
The first "min" argument controls the typical error rate in multiplexed
runs ("lanelets") from the same sample\&. Lanelets with error rate less
than this will always be considered as coming from the same sample\&.
The second "max" argument is the reverse: lanelets with error rate
greater than the absolute value of this parameter will always be
considered as different samples\&. When the value is negative, the cutoff
may be heuristically lowered by the clustering engine\&. If positive, the
value is interpreted as a fixed cutoff\&.
.fi
.if n \{\
.RE
.\}
.RE
.PP
\fB\-g, \-\-genotypes\fR \fIgenotypes\&.vcf\&.gz\fR
.RS 4
reference genotypes to compare against
.RE
.PP
\fB\-G, \-\-GTs\-only\fR \fIINT\fR
.RS 4
use genotypes (GT) instead of genotype likelihoods (PL)\&. When set to 1, reported discordance is the number of non\-matching GTs, otherwise the number
\fIINT\fR
is interpreted as phred\-scaled likelihood of unobserved genotypes\&.
.RE
.PP
\fB\-H, \-\-homs\-only\fR
.RS 4
consider only genotypes which are homozygous in both
\fIgenotypes\fR
and
\fIquery\fR
VCF\&. This may be useful with low coverage data\&.
.RE
.PP
\fB\-p, \-\-plot\fR \fIPREFIX\fR
.RS 4
produce plots
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-query\-sample\fR \fISTRING\fR
.RS 4
query sample in
\fIquery\&.vcf\&.gz\fR\&. By default, the first sample is checked\&.
.RE
.PP
\fB\-S, \-\-target\-sample\fR \fISTRING\fR
.RS 4
target sample in the
\fB\-g\fR
file, used only for plotting, not for analysis
.RE
.PP
\fB\-t, \-\-targets\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBOutput files format:\fR
.RS 4
.PP
CN, Discordance
.RS 4
Pairwise discordance for all sample pairs is calculated as
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
        \esum_s { min_G { PL_a(G) + PL_b(G) } },
.fi
.if n \{\
.RE
.\}
.PP
.RS 4
where the sum runs over all sites
\fIs\fR
and
\fIG\fR
is the the most likely genotype shared by both samples
\fIa\fR
and
\fIb\fR\&. When PL field is not present, a constant value
\fI99\fR
is used for the unseen genotypes\&. With
\fB\-G\fR, the value
\fI1\fR
can be used instead; the discordance value then gives exactly the number of differing genotypes\&.
.RE
.PP
ERR, error rate
.RS 4
Pairwise error rate calculated as number of differences divided by the total number of comparisons\&.
.RE
.PP
CLUSTER, TH, DOT
.RS 4
In presence of multiple samples, related samples and outliers can be identified by clustering samples by error rate\&. A simple hierarchical clustering based on minimization of standard deviation is used\&. This is useful to detect sample swaps, for example in situations where one sample has been sequenced in multiple runs\&.
.RE
.RE
.SS "bcftools index [\fIOPTIONS\fR] \fIin\&.bcf\fR|\fIin\&.vcf\&.gz\fR"
.sp
Creates index for bgzip compressed VCF/BCF files for random access\&. CSI (coordinate\-sorted index) is created by default\&. The CSI format supports indexing of chromosomes up to length 2^31\&. TBI (tabix index) index files, which support chromosome lengths up to 2^29, can be created by using the \fI\-t/\-\-tbi\fR option or using the \fItabix\fR program packaged with htslib\&. When loading an index file, bcftools will try the CSI first and then the TBI\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBIndexing options:\fR
.RS 4
.PP
\fB\-c, \-\-csi\fR
.RS 4
generate CSI\-format index for VCF/BCF files [default]
.RE
.PP
\fB\-f, \-\-force\fR
.RS 4
overwrite index if it already exists
.RE
.PP
\fB\-m, \-\-min\-shift \fR\fB\fIINT\fR\fR
.RS 4
set minimal interval size for CSI indices to 2^INT; default: 14
.RE
.PP
\fB\-o, \-\-output\-file \fR\fB\fIFILE\fR\fR
.RS 4
output file name\&. If not set, then the index will be created using the input file name plus a
\fI\&.csi\fR
or
\fI\&.tbi\fR
extension
.RE
.PP
\fB\-t, \-\-tbi\fR
.RS 4
generate TBI\-format index for VCF files
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBStats options:\fR
.RS 4
.PP
\fB\-n, \-\-nrecords\fR
.RS 4
print the number of records based on the CSI or TBI index files
.RE
.PP
\fB\-s, \-\-stats\fR
.RS 4
Print per contig stats based on the CSI or TBI index files\&. Output format is three tab\-delimited columns listing the contig name, contig length (\fI\&.\fR
if unknown) and number of records for the contig\&. Contigs with zero records are not printed\&.
.RE
.RE
.SS "bcftools isec [\fIOPTIONS\fR] \fIA\&.vcf\&.gz\fR \fIB\&.vcf\&.gz\fR [\&...]"
.sp
Creates intersections, unions and complements of VCF files\&. Depending on the options, the program can output records from one (or more) files which have (or do not have) corresponding records with the same position in the other files\&.
.PP
\fB\-c, \-\-collapse\fR \fIsnps\fR|\fIindels\fR|\fIboth\fR|\fIall\fR|\fIsome\fR|\fInone\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-C, \-\-complement\fR
.RS 4
output positions present only in the first file but missing in the others
.RE
.PP
\fB\-e, \-\-exclude\fR \fI\-\fR|\fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. If
\fB\-e\fR
(or
\fB\-i\fR) appears only once, the same filtering expression will be applied to all input files\&. Otherwise,
\fB\-e\fR
or
\fB\-i\fR
must be given for each input file\&. To indicate that no filtering should be performed on a file, use "\-" in place of
\fIEXPRESSION\fR, as shown in the example below\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-f, \-\-apply\-filters\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. See discussion of
\fB\-e, \-\-exclude\fR
above\&.
.RE
.PP
\fB\-n, \-\-nfiles\fR [+\-=]\fIINT\fR|~\fIBITMAP\fR
.RS 4
output positions present in this many (=), this many or more (+), this many or fewer (\-), or the exact same (~) files
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR\&. When several files are being output, their names are controlled via
\fB\-p\fR
instead\&.
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-p, \-\-prefix\fR \fIDIR\fR
.RS 4
if given, subset each of the input files accordingly\&. See also
\fB\-w\fR\&.
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-w, \-\-write\fR \fILIST\fR
.RS 4
list of input files to output given as 1\-based indices\&. With
\fB\-p\fR
and no
\fB\-w\fR, all files are written\&.
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBExamples:\fR
.RS 4
.sp
Create intersection and complements of two sets saving the output in dir/*
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools isec \-p dir A\&.vcf\&.gz B\&.vcf\&.gz
.fi
.if n \{\
.RE
.\}
.sp
Filter sites in A (require INFO/MAF>=0\&.01) and B (require INFO/dbSNP) but not in C, and create an intersection, including only sites which appear in at least two of the files after filters have been applied
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools isec \-e\*(AqMAF<0\&.01\*(Aq \-i\*(AqdbSNP=1\*(Aq \-e\- A\&.vcf\&.gz B\&.vcf\&.gz C\&.vcf\&.gz \-n +2 \-p dir
.fi
.if n \{\
.RE
.\}
.sp
Extract and write records from A shared by both A and B using exact allele match
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools isec \-p dir \-n=2 \-w1 A\&.vcf\&.gz B\&.vcf\&.gz
.fi
.if n \{\
.RE
.\}
.sp
Extract records private to A or B comparing by position only
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools isec \-p dir \-n\-1 \-c all A\&.vcf\&.gz B\&.vcf\&.gz
.fi
.if n \{\
.RE
.\}
.sp
Print a list of records which are present in A and B but not in C and D
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools isec \-n~1100 \-c all A\&.vcf\&.gz B\&.vcf\&.gz C\&.vcf\&.gz D\&.vcf\&.gz
.fi
.if n \{\
.RE
.\}
.RE
.SS "bcftools merge [\fIOPTIONS\fR] \fIA\&.vcf\&.gz\fR \fIB\&.vcf\&.gz\fR [\&...]"
.sp
Merge multiple VCF/BCF files from non\-overlapping sample sets to create one multi\-sample file\&. For example, when merging file \fIA\&.vcf\&.gz\fR containing samples \fIS1\fR, \fIS2\fR and \fIS3\fR and file \fIB\&.vcf\&.gz\fR containing samples \fIS3\fR and \fIS4\fR, the output file will contain four samples named \fIS1\fR, \fIS2\fR, \fIS3\fR, \fI2:S3\fR and \fIS4\fR\&.
.sp
Note that it is responsibility of the user to ensure that the sample names are unique across all files\&. If they are not, the program will exit with an error unless the option \fB\-\-force\-samples\fR is given\&. The sample names can be also given explicitly using the \fB\-\-print\-header\fR and \fB\-\-use\-header\fR options\&.
.sp
Note that only records from different files can be merged, never from the same file\&. For "vertical" merge take a look at \fBbcftools concat\fR or \fBbcftools norm\fR\fB \-m\fR instead\&.
.PP
\fB\-\-force\-samples\fR
.RS 4
if the merged files contain duplicate samples names, proceed anyway\&. Duplicate sample names will be resolved by prepending index of the file as it appeared on the command line to the conflicting sample name (see
\fI2:S3\fR
in the above example)\&.
.RE
.PP
\fB\-\-print\-header\fR
.RS 4
print only merged header and exit
.RE
.PP
\fB\-\-use\-header\fR \fIFILE\fR
.RS 4
use the VCF header in the provided text
\fIFILE\fR
.RE
.PP
\fB\-0 \-\-missing\-to\-ref\fR
.RS 4
assume genotypes at missing sites are 0/0
.RE
.PP
\fB\-f, \-\-apply\-filters\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-F, \-\-filter\-logic\fR \fIx\fR|\fI+\fR
.RS 4
Set the output record to PASS if any of the inputs is PASS (\fIx\fR), or apply all filters (\fI+\fR), which is the default\&.
.RE
.PP
\fB\-g, \-\-gvcf\fR \fI\-\fR|\fIFILE\fR
.RS 4
merge gVCF blocks, INFO/END tag is expected\&. If the reference fasta file
\fIFILE\fR
is not given and the dash (\fI\-\fR) is given, unknown reference bases generated at gVCF block splits will be substituted with N\(cqs\&. The
\fB\-\-gvcf\fR
option uses the following default INFO rules:
\fB\-i QS:sum,MinDP:min,I16:sum,IDV:max,IMF:max\fR\&.
.RE
.PP
\fB\-i, \-\-info\-rules\fR \fI\-\fR|\fITAG:METHOD\fR[,\&...]
.RS 4
Rules for merging INFO fields (scalars or vectors) or
\fI\-\fR
to disable the default rules\&.
\fIMETHOD\fR
is one of
\fIsum\fR,
\fIavg\fR,
\fImin\fR,
\fImax\fR,
\fIjoin\fR\&. Default is
\fIDP:sum,DP4:sum\fR
if these fields exist in the input files\&. Fields with no specified rule will take the value from the first input file\&. The merged QUAL value is currently set to the maximum\&. This behaviour is not user controllable at the moment\&.
.RE
.PP
\fB\-l, \-\-file\-list\fR \fIFILE\fR
.RS 4
Read file names from
\fIFILE\fR, one file name per line\&.
.RE
.PP
\fB\-m, \-\-merge\fR \fIsnps\fR|\fIindels\fR|\fIboth\fR|\fIall\fR|\fInone\fR|\fIid\fR
.RS 4
The option controls what types of multiallelic records can be created:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
\-m none   \&.\&.  no new multiallelics, output multiple records instead
\-m snps   \&.\&.  allow multiallelic SNP records
\-m indels \&.\&.  allow multiallelic indel records
\-m both   \&.\&.  both SNP and indel records can be multiallelic
\-m all    \&.\&.  SNP records can be merged with indel records
\-m id     \&.\&.  merge by ID
.fi
.if n \{\
.RE
.\}
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.SS "bcftools mpileup [\fIOPTIONS\fR] \-f \fIref\&.fa\fR \fIin\&.bam\fR [\fIin2\&.bam\fR [\&...]]"
.sp
Generate VCF or BCF containing genotype likelihoods for one or multiple alignment (BAM or CRAM) files\&. This is based on the original \fBsamtools mpileup\fR command (with the \fB\-v\fR or \fB\-g\fR options) producing genotype likelihoods in VCF or BCF format, but not the textual pileup output\&. The \fBmpileup\fR command was transferred to bcftools in order to avoid errors resulting from use of incompatible versions of samtools and bcftools when using in the mpileup+bcftools call pipeline\&.
.sp
Individuals are identified from the SM tags in the @RG header lines\&. Multiple individuals can be pooled in one alignment file, also one individual can be separated into multiple files\&. If sample identifiers are absent, each input file is regarded as one sample\&.
.sp
Note that there are two orthogonal ways to specify locations in the input file; via \fB\-r\fR \fIregion\fR and \fB\-t\fR \fIpositions\fR\&. The former uses (and requires) an index to do random access while the latter streams through the file contents filtering out the specified regions, requiring no index\&. The two may be used in conjunction\&. For example a BED file containing locations of genes in chromosome 20 could be specified using \fB\-r 20 \-t chr20\&.bed\fR, meaning that the index is used to find chromosome 20 and then it is filtered for the regions listed in the BED file\&. Also note that the \fB\-r\fR option can be much slower than \fB\-t\fR with many regions and can require more memory when multiple regions and many alignment files are processed\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBInput options\fR
.RS 4
.PP
\fB\-6, \-\-illumina1\&.3+\fR
.RS 4
Assume the quality is in the Illumina 1\&.3+ encoding\&.
.RE
.PP
\fB\-A, \-\-count\-orphans\fR
.RS 4
Do not skip anomalous read pairs in variant calling\&.
.RE
.PP
\fB\-b, \-\-bam\-list\fR \fIFILE\fR
.RS 4
List of input alignment files, one file per line [null]
.RE
.PP
\fB\-B, \-\-no\-BAQ\fR
.RS 4
Disable probabilistic realignment for the computation of base alignment quality (BAQ)\&. BAQ is the Phred\-scaled probability of a read base being misaligned\&. Applying this option greatly helps to reduce false SNPs caused by misalignments\&.
.RE
.PP
\fB\-C, \-\-adjust\-MQ\fR \fIINT\fR
.RS 4
Coefficient for downgrading mapping quality for reads containing excessive mismatches\&. Given a read with a phred\-scaled probability q of being generated from the mapped posi\- tion, the new mapping quality is about sqrt((INT\-q)/INT)*INT\&. A zero value disables this functionality; if enabled, the recommended value for BWA is 50\&. [0]
.RE
.PP
\fB\-d, \-\-max\-depth\fR \fIINT\fR
.RS 4
At a position, read maximally
\fIINT\fR
reads per input file\&. Note that bcftools has a minimum value of
\fI8000/n\fR
where
\fIn\fR
is the number of input files given to mpileup\&. This means the default is highly likely to be increased\&. Once above the cross\-sample minimum of 8000 the \-d parameter will have an effect\&. [250]
.RE
.PP
\fB\-E, \-\-redo\-BAQ\fR
.RS 4
Recalculate BAQ on the fly, ignore existing BQ tags
.RE
.PP
\fB\-f, \-\-fasta\-ref\fR \fIFILE\fR
.RS 4
The
\fBfaidx\fR\-indexed reference file in the FASTA format\&. The file can be optionally compressed by
\fBbgzip\fR\&. Reference is required by default unless the
\fB\-\-no\-reference\fR
option is set [null]
.RE
.PP
\fB\-\-no\-reference\fR
.RS 4
Do not require the
\fB\-\-fasta\-ref\fR
option\&.
.RE
.PP
\fB\-G, \-\-read\-groups\fR \fIFILE\fR
.RS 4
list of read groups to include or exclude if prefixed with "^"\&. One read group per line\&. This file can also be used to assign new sample names to read groups by giving the new sample name as a second white\-space\-separated field, like this: "read_group_id new_sample_name"\&. If the read group name is not unique, also the bam file name can be included: "read_group_id file_name sample_name"\&. If all reads from the alignment file should be treated as a single sample, the asterisk symbol can be used: "* file_name sample_name"\&. Alignments without a read group ID can be matched with "?"\&.
\fBNOTE:\fR
The meaning of
\fBbcftools mpileup \-G\fR
is the opposite of
\fBsamtools mpileup \-G\fR\&.
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    RG_ID_1
    RG_ID_2  SAMPLE_A
    RG_ID_3  SAMPLE_A
    RG_ID_4  SAMPLE_B
    RG_ID_5  FILE_1\&.bam  SAMPLE_A
    RG_ID_6  FILE_2\&.bam  SAMPLE_A
    *        FILE_3\&.bam  SAMPLE_C
    ?        FILE_3\&.bam  SAMPLE_D
.fi
.if n \{\
.RE
.\}
.PP
\fB\-q, \-min\-MQ\fR \fIINT\fR
.RS 4
Minimum mapping quality for an alignment to be used [0]
.RE
.PP
\fB\-Q, \-\-min\-BQ\fR \fIINT\fR
.RS 4
Minimum base quality for a base to be considered [13]
.RE
.PP
\fB\-r, \-\-regions\fR \fICHR\fR|\fICHR:POS\fR|\fICHR:FROM\-TO\fR|\fICHR:FROM\-\fR[,\&...]
.RS 4
Only generate mpileup output in given regions\&. Requires the alignment files to be indexed\&. If used in conjunction with \-l then considers the intersection; see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIFILE\fR
.RS 4
As for
\fB\-r, \-\-regions\fR, but regions read from FILE; see
\fBCommon Options\fR
.RE
.PP
\fB\-\-ignore\-RG\fR
.RS 4
Ignore RG tags\&. Treat all reads in one alignment file as one sample\&.
.RE
.PP
\fB\-\-rf, \-\-incl\-flags\fR \fISTR\fR|\fIINT\fR
.RS 4
Required flags: skip reads with mask bits unset [null]
.RE
.PP
\fB\-\-ff, \-\-excl\-flags\fR \fISTR\fR|\fIINT\fR
.RS 4
Filter flags: skip reads with mask bits set [UNMAP,SECONDARY,QCFAIL,DUP]
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
list of sample names\&. See
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
file of sample names to include or exclude if prefixed with "^"\&. One sample per line\&. This file can also be used to rename samples by giving the new sample name as a second white\-space\-separated column, like this: "old_name new_name"\&. If a sample name contains spaces, the spaces can be escaped using the backslash character, for example "Not\e a\e good\e sample\e name"\&.
.RE
.PP
\fB\-t, \-\-targets\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-x, \-\-ignore\-overlaps\fR
.RS 4
Disable read\-pair overlap detection\&.
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBOutput options\fR
.RS 4
.PP
\fB\-a, \-\-annotate\fR \fILIST\fR
.RS 4
Comma\-separated list of FORMAT and INFO tags to output\&. (case\-insensitive, the "FORMAT/" prefix is optional, and use "?" to list available annotations on the command line) [null]:
.sp
.if n \{\
.RS 4
.\}
.nf
*FORMAT/AD* \&.\&. Allelic depth (Number=R,Type=Integer)
*FORMAT/ADF* \&.\&. Allelic depths on the forward strand (Number=R,Type=Integer)
*FORMAT/ADR* \&.\&. Allelic depths on the reverse strand (Number=R,Type=Integer)
*FORMAT/DP* \&.\&. Number of high\-quality bases (Number=1,Type=Integer)
*FORMAT/SP* \&.\&. Phred\-scaled strand bias P\-value (Number=1,Type=Integer)
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
*INFO/AD* \&.\&. Total allelic depth (Number=R,Type=Integer)
*INFO/ADF* \&.\&. Total allelic depths on the forward strand (Number=R,Type=Integer)
*INFO/ADR* \&.\&. Total allelic depths on the reverse strand (Number=R,Type=Integer)
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
*FORMAT/DV* \&.\&. Deprecated in favor of FORMAT/AD;
        Number of high\-quality non\-reference bases, (Number=1,Type=Integer)
*FORMAT/DP4* \&.\&. Deprecated in favor of FORMAT/ADF and FORMAT/ADR;
        Number of high\-quality ref\-forward, ref\-reverse,
        alt\-forward and alt\-reverse bases (Number=4,Type=Integer)
*FORMAT/DPR* \&.\&. Deprecated in favor of FORMAT/AD;
        Number of high\-quality bases for each observed allele (Number=R,Type=Integer)
*INFO/DPR* \&.\&. Deprecated in favor of INFO/AD;
        Number of high\-quality bases for each observed allele (Number=R,Type=Integer)
.fi
.if n \{\
.RE
.\}
.RE
.PP
\fB\-g, \-\-gvcf\fR \fIINT\fR[,\&...]
.RS 4
output gVCF blocks of homozygous REF calls, with depth (DP) ranges specified by the list of integers\&. For example, passing
\fI5,15\fR
will group sites into two types of gVCF blocks, the first with minimum per\-sample DP from the interval [5,15) and the latter with minimum depth 15 or more\&. In this example, sites with minimum per\-sample depth less than 5 will be printed as separate records, outside of gVCF blocks\&.
.RE
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
Write output to
\fIFILE\fR, rather than the default of standard output\&. (The same short option is used for both
\fB\-\-open\-prob\fR
and
\fB\-\-output\fR\&. If
\fB\-o\fR\*(Aqs argument contains any non\-digit characters other than a leading + or \- sign, it is interpreted as
\fB\-\-output\fR\&. Usually the filename extension will take care of this, but to write to an entirely numeric filename use
\fB\-o \&./123\fR
or
\fB\-\-output 123\fR\&.)
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBOptions for SNP/INDEL genotype likelihood computation\fR
.RS 4
.PP
\fB\-e, \-\-ext\-prob\fR \fIINT\fR
.RS 4
Phred\-scaled gap extension sequencing error probability\&. Reducing
\fIINT\fR
leads to longer indels [20]
.RE
.PP
\fB\-F, \-\-gap\-frac\fR \fIFLOAT\fR
.RS 4
Minimum fraction of gapped reads [0\&.002]
.RE
.PP
\fB\-h, \-\-tandem\-qual\fR \fIINT\fR
.RS 4
Coefficient for modeling homopolymer errors\&. Given an
\fIl\fR\-long homopolymer run, the sequencing error of an indel of size s is modeled as
\fIINT\fR*s/l [100]
.RE
.PP
\fB\-I, \-\-skip\-indels\fR
.RS 4
Do not perform INDEL calling
.RE
.PP
\fB\-L, \-\-max\-idepth\fR \fIINT\fR
.RS 4
Skip INDEL calling if the average per\-sample depth is above
\fIINT\fR
[250]
.RE
.PP
\fB\-m, \-\-min\-ireads\fR \fIINT\fR
.RS 4
Minimum number gapped reads for indel candidates
\fIINT\fR
[1]
.RE
.PP
\fB\-o, \-\-open\-prob\fR \fIINT\fR
.RS 4
Phred\-scaled gap open sequencing error probability\&. Reducing
\fIINT\fR
leads to more indel calls\&. (The same short option is used for both
\fB\-\-open\-prob\fR
and
\fB\-\-output\fR\&. When \-o\(cqs argument contains only an optional + or \- sign followed by the digits 0 to 9, it is interpreted as
\fB\-\-open\-prob\fR\&.) [40]
.RE
.PP
\fB\-p, \-\-per\-sample\-mF\fR
.RS 4
Apply
\fB\-m\fR
and
\fB\-F\fR
thresholds per sample to increase sensitivity of calling\&. By default both options are applied to reads pooled from all samples\&.
.RE
.PP
\fB\-P, \-\-platforms\fR \fISTR\fR
.RS 4
Comma\-delimited list of platforms (determined by
\fB@RG\-PL\fR) from which indel candidates are obtained\&. It is recommended to collect indel candidates from sequencing technologies that have low indel error rate such as ILLUMINA [all]
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBExamples:\fR
.RS 4
.sp
Call SNPs and short INDELs, then mark low quality sites and sites with the read depth exceeding a limit\&. (The read depth should be adjusted to about twice the average read depth as higher read depths usually indicate problematic regions which are often enriched for artefacts\&.) One may consider to add \fB\-C50\fR to mpileup if mapping quality is overestimated for reads containing excessive mismatches\&. Applying this option usually helps for BWA\-backtrack alignments, but may not other aligners\&.
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools mpileup \-Ou \-f ref\&.fa aln\&.bam | \e
    bcftools call \-Ou \-mv | \e
    bcftools filter \-s LowQual \-e \*(Aq%QUAL<20 || DP>100\*(Aq > var\&.flt\&.vcf
.fi
.if n \{\
.RE
.\}
.RE
.SS "bcftools norm [\fIOPTIONS\fR] \fIfile\&.vcf\&.gz\fR"
.sp
Left\-align and normalize indels, check if REF alleles match the reference, split multiallelic sites into multiple rows; recover multiallelics from multiple rows\&. Left\-alignment and normalization will only be applied if the \fB\-\-fasta\-ref\fR option is supplied\&.
.PP
\fB\-c, \-\-check\-ref\fR \fIe\fR|\fIw\fR|\fIx\fR|\fIs\fR
.RS 4
what to do when incorrect or missing REF allele is encountered: exit (\fIe\fR), warn (\fIw\fR), exclude (\fIx\fR), or set/fix (\fIs\fR) bad sites\&. The
\fIw\fR
option can be combined with
\fIx\fR
and
\fIs\fR\&. Note that
\fIs\fR
can swap alleles and will update genotypes (GT) and AC counts, but will not attempt to fix PL or other fields\&.
.RE
.PP
\fB\-d, \-\-rm\-dup\fR \fIsnps\fR|\fIindels\fR|\fIboth\fR|\fIall\fR|\fInone\fR
.RS 4
If a record is present multiple times, output only the first instance, see
\fB\-\-collapse\fR
in
\fBCommon Options\fR\&.
.RE
.PP
\fB\-D, \-\-remove\-duplicates\fR
.RS 4
If a record is present in multiple files, output only the first instance\&. Alias for
\fB\-d none\fR, deprecated\&.
.RE
.PP
\fB\-f, \-\-fasta\-ref\fR \fIFILE\fR
.RS 4
reference sequence\&. Supplying this option will turn on left\-alignment and normalization, however, see also the
\fB\-\-do\-not\-normalize\fR
option below\&.
.RE
.PP
\fB\-m, \-\-multiallelics\fR \fB\-\fR|\fB+\fR[\fIsnps\fR|\fIindels\fR|\fIboth\fR|\fIany\fR]
.RS 4
split multiallelic sites into biallelic records (\fB\-\fR) or join biallelic sites into multiallelic records (\fB+\fR)\&. An optional type string can follow which controls variant types which should be split or merged together: If only SNP records should be split or merged, specify
\fIsnps\fR; if both SNPs and indels should be merged separately into two records, specify
\fIboth\fR; if SNPs and indels should be merged into a single record, specify
\fIany\fR\&.
.RE
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-N, \-\-do\-not\-normalize\fR
.RS 4
the
\fI\-c s\fR
option can be used to fix or set the REF allele from the reference
\fI\-f\fR\&. The
\fI\-N\fR
option will not turn on indel normalisation as the
\fI\-f\fR
option normally implies
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-strict\-filter\fR
.RS 4
when merging (\fI\-m+\fR), merged site is PASS only if all sites being merged PASS
.RE
.PP
\fB\-t, \-\-targets\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-w, \-\-site\-win\fR \fIINT\fR
.RS 4
maximum distance between two records to consider when locally sorting variants which changed position during the realignment
.RE
.SS "bcftools [plugin \fINAME\fR|+\fINAME\fR] \fI[OPTIONS]\fR \fIFILE\fR \(em \fI[PLUGIN OPTIONS]\fR"
.sp
A common framework for various utilities\&. The plugins can be used the same way as normal commands only their name is prefixed with "+"\&. Most plugins accept two types of parameters: general options shared by all plugins followed by a separator, and a list of plugin\-specific options\&. There are some exceptions to this rule, some plugins do not accept the common options and implement their own parameters\&. Therefore please pay attention to the usage examples that each plugin comes with\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBVCF input options:\fR
.RS 4
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBVCF output options:\fR
.RS 4
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBPlugin options:\fR
.RS 4
.PP
\fB\-h, \-\-help\fR
.RS 4
list plugin\(cqs options
.RE
.PP
\fB\-l, \-\-list\-plugins\fR
.RS 4
List all available plugins\&.
.sp
By default, appropriate system directories are searched for installed plugins\&. You can override this by setting the BCFTOOLS_PLUGINS environment variable to a colon\-separated list of directories to search\&. If BCFTOOLS_PLUGINS begins with a colon, ends with a colon, or contains adjacent colons, the system directories are also searched at that position in the list of directories\&.
.RE
.PP
\fB\-v, \-\-verbose\fR
.RS 4
print debugging information to debug plugin failure
.RE
.PP
\fB\-V, \-\-version\fR
.RS 4
print version string and exit
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBList of plugins coming with the distribution:\fR
.RS 4
.PP
\fBGTisec\fR
.RS 4
count genotype intersections across all possible sample subsets in a vcf file
.RE
.PP
\fBGTsubset\fR
.RS 4
output only sites where the requested samples all exclusively share a genotype
.RE
.PP
\fBad\-bias\fR
.RS 4
find positions with wildly varying ALT allele frequency (Fisher test on FMT/AD)
.RE
.PP
\fBaf\-dist\fR
.RS 4
collect AF deviation stats and GT probability distribution given AF and assuming HWE
.RE
.PP
\fBcheck\-ploidy\fR
.RS 4
check if ploidy of samples is consistent for all sites
.RE
.PP
\fBcheck\-sparsity\fR
.RS 4
print samples without genotypes in a region or chromosome
.RE
.PP
\fBcolor\-chrs\fR
.RS 4
color shared chromosomal segments, requires trio VCF with phased GTs
.RE
.PP
\fBcounts\fR
.RS 4
a minimal plugin which counts number of SNPs, Indels, and total number of sites\&.
.RE
.PP
\fBdosage\fR
.RS 4
print genotype dosage\&. By default the plugin searches for PL, GL and GT, in that order\&.
.RE
.PP
\fBfill\-AN\-AC\fR
.RS 4
fill INFO fields AN and AC\&.
.RE
.PP
\fBfill\-from\-fasta\fR
.RS 4
fill INFO or REF field based on values in a fasta file
.RE
.PP
\fBfill\-tags\fR
.RS 4
set INFO tags AF, AC, AC_Hemi, AC_Hom, AC_Het, AN, HWE, MAF, NS
.RE
.PP
\fBfix\-ploidy\fR
.RS 4
sets correct ploidy
.RE
.PP
\fBfixref\fR
.RS 4
determine and fix strand orientation
.RE
.PP
\fBframeshifts\fR
.RS 4
annotate frameshift indels
.RE
.PP
\fBguess\-ploidy\fR
.RS 4
determine sample sex by checking genotype likelihoods (GL,PL) or genotypes (GT) in the non\-PAR region of chrX\&.
.RE
.PP
\fBimpute\-info\fR
.RS 4
add imputation information metrics to the INFO field based on selected FORMAT tags
.RE
.PP
\fBisecGT\fR
.RS 4
compare two files and set non\-identical genotypes to missing
.RE
.PP
\fBmendelian\fR
.RS 4
count Mendelian consistent / inconsistent genotypes\&.
.RE
.PP
\fBmissing2ref\fR
.RS 4
sets missing genotypes ("\&./\&.") to ref allele ("0/0" or "0|0")
.RE
.PP
\fBprune\fR
.RS 4
prune sites by missingness or linkage disequilibrium
.RE
.PP
\fBsetGT\fR
.RS 4
general tool to set genotypes according to rules requested by the user
.RE
.PP
\fBtag2tag\fR
.RS 4
convert between similar tags, such as GL and GP
.RE
.PP
\fBtrio\-switch\-rate\fR
.RS 4
calculate phase switch rate in trio samples, children samples must have phased GTs\&.
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBExamples:\fR
.RS 4
.sp
.if n \{\
.RS 4
.\}
.nf
# List options common to all plugins
bcftools plugin

# List available plugins
bcftools plugin \-l

# Run a plugin
bcftools plugin counts in\&.vcf

# Run a plugin using the abbreviated "+" notation
bcftools +counts in\&.vcf

# The input VCF can be streamed just like in other commands
cat in\&.vcf | bcftools +counts

# Print usage information of plugin "dosage"
bcftools +dosage \-h

# Replace missing genotypes with 0/0
bcftools +missing2ref in\&.vcf

# Replace missing genotypes with 0|0
bcftools +missing2ref in\&.vcf \-\- \-p
.fi
.if n \{\
.RE
.\}
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBPlugins troubleshooting:\fR
.RS 4
.sp
Things to check if your plugin does not show up in the \fBbcftools plugin \-l\fR output:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Run with the
\fB\-v\fR
option for verbose output:
\fBbcftools plugin \-lv\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Does the environment variable BCFTOOLS_PLUGINS include the correct path?
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBPlugins API:\fR
.RS 4
.sp
.if n \{\
.RS 4
.\}
.nf
// Short description used by \*(Aqbcftools plugin \-l\*(Aq
const char *about(void);

// Longer description used by \*(Aqbcftools +name \-h\*(Aq
const char *usage(void);

// Called once at startup, allows initialization of local variables\&.
// Return 1 to suppress normal VCF/BCF header output, \-1 on critical
// errors, 0 otherwise\&.
int init(int argc, char **argv, bcf_hdr_t *in_hdr, bcf_hdr_t *out_hdr);

// Called for each VCF record, return NULL to suppress the output
bcf1_t *process(bcf1_t *rec);

// Called after all lines have been processed to clean up
void destroy(void);
.fi
.if n \{\
.RE
.\}
.RE
.SS "bcftools polysomy [\fIOPTIONS\fR] \fIfile\&.vcf\&.gz\fR"
.sp
Detect number of chromosomal copies in VCFs annotates with the Illumina\(cqs B\-allele frequency (BAF) values\&. Note that this command is not compiled in by default, see the section \fBOptional Compilation with GSL\fR in the INSTALL file for help\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBGeneral options:\fR
.RS 4
.PP
\fB\-o, \-\-output\-dir\fR \fIpath\fR
.RS 4
output directory
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-sample\fR \fIstring\fR
.RS 4
sample name
.RE
.PP
\fB\-t, \-\-targets\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-v, \-\-verbose\fR
.RS 4
verbose debugging output which gives hints about the thresholds and decisions made by the program\&. Note that the exact output can change between versions\&.
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBAlgorithm options:\fR
.RS 4
.PP
\fB\-b, \-\-peak\-size\fR \fIfloat\fR
.RS 4
the minimum peak size considered as a good match can be from the interval [0,1] where larger is stricter
.RE
.PP
\fB\-c, \-\-cn\-penalty\fR \fIfloat\fR
.RS 4
a penalty for increasing copy number state\&. How this works: multiple peaks are always a better fit than a single peak, therefore the program prefers a single peak (normal copy number) unless the absolute deviation of the multiple peaks fit is significantly smaller\&. Here the meaning of "significant" is given by the
\fIfloat\fR
from the interval [0,1] where larger is stricter\&.
.RE
.PP
\fB\-f, \-\-fit\-th\fR \fIfloat\fR
.RS 4
threshold for goodness of fit (normalized absolute deviation), smaller is stricter
.RE
.PP
\fB\-i, \-\-include\-aa\fR
.RS 4
include also the AA peak in CN2 and CN3 evaluation\&. This usually requires increasing
\fB\-f\fR\&.
.RE
.PP
\fB\-m, \-\-min\-fraction\fR \fIfloat\fR
.RS 4
minimum distinguishable fraction of aberrant cells\&. The experience shows that trustworthy are estimates of 20% and more\&.
.RE
.PP
\fB\-p, \-\-peak\-symmetry\fR \fIfloat\fR
.RS 4
a heuristics to filter failed fits where the expected peak symmetry is violated\&. The
\fIfloat\fR
is from the interval [0,1] and larger is stricter
.RE
.RE
.SS "bcftools query [\fIOPTIONS\fR] \fIfile\&.vcf\&.gz\fR [\fIfile\&.vcf\&.gz\fR [\&...]]"
.sp
Extracts fields from VCF or BCF files and outputs them in user\-defined format\&.
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-f, \-\-format\fR \fIFORMAT\fR
.RS 4
learn by example, see below
.RE
.PP
\fB\-H, \-\-print\-header\fR
.RS 4
print header
.RE
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-l, \-\-list\-samples\fR
.RS 4
list sample names and exit
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-u, \-\-allow\-undef\-tags\fR
.RS 4
do not throw an error if there are undefined tags in the format string, print "\&." instead
.RE
.PP
\fB\-v, \-\-vcf\-list\fR \fIFILE\fR
.RS 4
process multiple VCFs listed in the file
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBFormat:\fR
.RS 4
.sp
.if n \{\
.RS 4
.\}
.nf
%CHROM          The CHROM column (similarly also other columns: POS, ID, REF, ALT, QUAL, FILTER)
%INFO/TAG       Any tag in the INFO column
%TYPE           Variant type (REF, SNP, MNP, INDEL, BND, OTHER)
%MASK           Indicates presence of the site in other files (with multiple files)
%TAG{INT}       Curly brackets to subscript vectors (0\-based)
%FIRST_ALT      Alias for %ALT{0}
[]              Format fields must be enclosed in brackets to loop over all samples
%GT             Genotype (e\&.g\&. 0/1)
%TBCSQ          Translated FORMAT/BCSQ\&. See the csq command above for explanation and examples\&.
%TGT            Translated genotype (e\&.g\&. C/A)
%IUPACGT        Genotype translated to IUPAC ambiguity codes (e\&.g\&. M instead of C/A)
%LINE           Prints the whole line
%SAMPLE         Sample name
%POS0           POS in 0\-based coordinates
%END            End position of the REF allele
%END0           End position of the REF allele in 0\-based cordinates
\en              new line
\et              tab character
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
Everything else is printed verbatim\&.
.fi
.if n \{\
.RE
.\}
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBExamples:\fR
.RS 4
.sp
.if n \{\
.RS 4
.\}
.nf
# Print chromosome, position, ref allele and the first alternate allele
bcftools query \-f \*(Aq%CHROM  %POS  %REF  %ALT{0}\en\*(Aq file\&.vcf\&.gz
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
# Similar to above, but use tabs instead of spaces, add sample name and genotype
bcftools query \-f \*(Aq%CHROM\et%POS\et%REF\et%ALT[\et%SAMPLE=%GT]\en\*(Aq file\&.vcf\&.gz
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
# Print FORMAT/GT fields followed by FORMAT/GT fields
bcftools query \-f \*(AqGQ:[ %GQ] \et GT:[ %GT]\en\*(Aq file\&.vcf
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
# Make a BED file: chr, pos (0\-based), end pos (1\-based), id
bcftools query \-f\*(Aq%CHROM\et%POS0\et%END\et%ID\en\*(Aq file\&.bcf
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
# Print only samples with alternate (non\-reference) genotypes
bcftools query \-f\*(Aq[%CHROM:%POS %SAMPLE %GT\en]\*(Aq \-i\*(AqGT="alt"\*(Aq file\&.bcf
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
# Print all samples at sites with at least one alternate genotype
bcftools view \-i\*(AqGT="alt"\*(Aq file\&.bcf \-Ou | bcftools query \-f\*(Aq[%CHROM:%POS %SAMPLE %GT\en]\*(Aq
.fi
.if n \{\
.RE
.\}
.RE
.SS "bcftools reheader [\fIOPTIONS\fR] \fIfile\&.vcf\&.gz\fR"
.sp
Modify header of VCF/BCF files, change sample names\&.
.PP
\fB\-h, \-\-header\fR \fIFILE\fR
.RS 4
new VCF header
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-samples\fR \fIFILE\fR
.RS 4
new sample names, one name per line, in the same order as they appear in the VCF file\&. Alternatively, only samples which need to be renamed can be listed as "old_name new_name\en" pairs separated by whitespaces, each on a separate line\&. If a sample name contains spaces, the spaces can be escaped using the backslash character, for example "Not\e a\e good\e sample\e name"\&.
.RE
.SS "bcftools roh [\fIOPTIONS\fR] \fIfile\&.vcf\&.gz\fR"
.sp
A program for detecting runs of homo/autozygosity\&. Only bi\-allelic sites are considered\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBThe HMM model:\fR
.RS 4
.sp
.if n \{\
.RS 4
.\}
.nf
Notation:
  D  = Data, AZ = autozygosity, HW = Hardy\-Weinberg (non\-autozygosity),
  f  = non\-ref allele frequency

Emission probabilities:
  oAZ = P_i(D|AZ) = (1\-f)*P(D|RR) + f*P(D|AA)
  oHW = P_i(D|HW) = (1\-f)^2 * P(D|RR) + f^2 * P(D|AA) + 2*f*(1\-f)*P(D|RA)

Transition probabilities:
  tAZ = P(AZ|HW)  \&.\&. from HW to AZ, the \-a parameter
  tHW = P(HW|AZ)  \&.\&. from AZ to HW, the \-H parameter

  ci  = P_i(C)  \&.\&. probability of cross\-over at site i, from genetic map
  AZi = P_i(AZ) \&.\&. probability of site i being AZ/non\-AZ, scaled so that AZi+HWi = 1
  HWi = P_i(HW)

  P_{i+1}(AZ) = oAZ * max[(1 \- tAZ * ci) * AZ{i\-1} , tAZ * ci * (1\-AZ{i\-1})]
  P_{i+1}(HW) = oHW * max[(1 \- tHW * ci) * (1\-AZ{i\-1}) , tHW * ci * AZ{i\-1}]
.fi
.if n \{\
.RE
.\}
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBGeneral Options:\fR
.RS 4
.PP
\fB\-\-AF\-dflt\fR \fIFLOAT\fR
.RS 4
in case allele frequency is not known, use the
\fIFLOAT\fR\&. By default, sites where allele frequency cannot be determined, or is 0, are skipped\&.
.RE
.PP
\fB\-\-AF\-tag\fR \fITAG\fR
.RS 4
use the specified INFO tag
\fITAG\fR
as an allele frequency estimate instead of the default AC and AN tags\&. Sites which do not have
\fITAG\fR
will be skipped\&.
.RE
.PP
\fB\-\-AF\-file\fR \fIFILE\fR
.RS 4
Read allele frequencies from a tab\-delimited file containing the columns: CHROM\etPOS\etREF,ALT\etAF\&. The file can be compressed with
\fBbgzip\fR
and indexed with tabix \-s1 \-b2 \-e2\&. Sites which are not present in the
\fIFILE\fR
or have different reference or alternate allele will be skipped\&. Note that such a file can be easily created from a VCF using:
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    bcftools query \-f\*(Aq%CHROM\et%POS\et%REF,%ALT\et%INFO/TAG\en\*(Aq file\&.vcf | bgzip \-c > freqs\&.tab\&.gz
.fi
.if n \{\
.RE
.\}
.PP
\fB\-b, \-\-buffer\-size\fR \fIINT\fR[,\fIINT\fR]
.RS 4
when the entire many\-sample file cannot fit into memory, a sliding buffer approach can be used\&. The first value is the number of sites to keep in memory\&. If negative, it is interpreted as the maximum memory to use, in MB\&. The second, optional, value sets the number of overlapping sites\&. The default overlap is set to roughly 1% of the buffer size\&.
.RE
.PP
\fB\-e, \-\-estimate\-AF\fR \fIFILE\fR
.RS 4
estimate the allele frequency by recalculating INFO/AC and INFO/AN on the fly, using the specified
\fITAG\fR
which can be either FORMAT/GT ("GT") or FORMAT/PL ("PL")\&. If
\fITAG\fR
is not given, "GT" is assumed\&. Either all samples ("\-") or samples listed in
\fIFILE\fR
will be included\&. For example, use "PL,\-" to estimate AF from FORMAT/PL of all samples\&. If neither
\fB\-e\fR
nor the other
\fB\-\-AF\-\&...\fR
options are given, the allele frequency is estimated from AC and AN counts which are already present in the INFO field\&.
.RE
.PP
\fB\-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-G, \-\-GTs\-only\fR \fIFLOAT\fR
.RS 4
use genotypes (FORMAT/GT fields) ignoring genotype likelihoods (FORMAT/PL), setting PL of unseen genotypes to
\fIFLOAT\fR\&. Safe value to use is 30 to account for GT errors\&.
.RE
.PP
\fB\-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-I, \-\-skip\-indels\fR
.RS 4
skip indels as their genotypes are usually enriched for errors
.RE
.PP
\fB\-m, \-\-genetic\-map\fR \fIFILE\fR
.RS 4
genetic map in the format required also by IMPUTE2\&. Only the first and third column are used (position and Genetic_Map(cM))\&. The
\fIFILE\fR
can chromosome name\&.
.RE
.PP
\fB\-M, \-\-rec\-rate\fR \fIFLOAT\fR
.RS 4
constant recombination rate per bp\&. In combination with
\fB\-\-genetic\-map\fR, the
\fB\-\-rec\-rate\fR
parameter is interpreted differently, as
\fIFLOAT\fR\-fold increase of transition probabilities, which allows the model to become more sensitive yet still account for recombination hotspots\&. Note that also the range of the values is therefore different in both cases: normally the parameter will be in the range (1e\-3,1e\-9) but with
\fB\-\-genetic\-map\fR
it will be in the range (10,1000)\&.
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
Write output to the
\fIFILE\fR, by default the output is printed on stdout
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIs\fR|\fIr\fR[\fIz\fR]
.RS 4
Generate per\-site output (\fIs\fR) or per\-region output (\fIr\fR)\&. By default both types are printed and the output is uncompressed\&. Add
\fIz\fR
for a compressed output\&.
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBHMM Options:\fR
.RS 4
.PP
\fB\-a, \-\-hw\-to\-az\fR \fIFLOAT\fR
.RS 4
P(AZ|HW) transition probability from AZ (autozygous) to HW (Hardy\-Weinberg) state
.RE
.PP
\fB\-H, \-\-az\-to\-hw\fR \fIFLOAT\fR
.RS 4
P(HW|AZ) transition probability from HW to AZ state
.RE
.PP
\fB\-V, \-\-viterbi\-training\fR \fIFLOAT\fR
.RS 4
estimate HMM parameters using Baum\-Welch algorithm, using the convergence threshold
\fIFLOAT\fR, e\&.g\&. 1e\-10 (experimental)
.RE
.RE
.SS "bcftools sort [\fIOPTIONS\fR] file\&.bcf"
.PP
\fB\-m, \-\-max\-mem\fR \fIFLOAT\fR[\fIkMG\fR]
.RS 4
Maximum memory to use\&. Approximate, affects the number of temporary files written to the disk\&. Note that if the command fails at this step because of too many open files, your system limit on the number of open files ("ulimit") may need to be increased\&.
.RE
.PP
\fB\-o, \-\-output\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-temp\-dir\fR \fIDIR\fR
.RS 4
Use this directory to store temporary files
.RE
.SS "bcftools stats [\fIOPTIONS\fR] \fIA\&.vcf\&.gz\fR [\fIB\&.vcf\&.gz\fR]"
.sp
Parses VCF or BCF and produces text file stats which is suitable for machine processing and can be plotted using \fBplot\-vcfstats\fR\&. When two files are given, the program generates separate stats for intersection and the complements\&. By default only sites are compared, \fB\-s\fR/\fB\-S\fR must given to include also sample columns\&. When one VCF file is specified on the command line, then stats by non\-reference allele frequency, depth distribution, stats by quality and per\-sample counts, singleton stats, etc\&. are printed\&. When two VCF files are given, then stats such as concordance (Genotype concordance by non\-reference allele frequency, Genotype concordance by sample, Non\-Reference Discordance) and correlation are also printed\&. Per\-site discordance (PSD) is also printed in \fB\-\-verbose\fR mode\&.
.PP
\fB\-\-af\-bins\fR \fILIST\fR|\fIFILE\fR
.RS 4
comma separated list of allele frequency bins (e\&.g\&. 0\&.1,0\&.5,1) or a file listing the allele frequency bins one per line (e\&.g\&. 0\&.1\en0\&.5\en1)
.RE
.PP
\fB\-\-af\-tag\fR \fITAG\fR
.RS 4
allele frequency INFO tag to use for binning\&. By default the allele frequency is estimated from AC/AN, if available, or directly from the genotypes (GT) if not\&.
.RE
.PP
\fB\-1, \-\-1st\-allele\-only\fR
.RS 4
consider only the 1st alternate allele at multiallelic sites
.RE
.PP
\fB\-c, \-\-collapse\fR \fIsnps\fR|\fIindels\fR|\fIboth\fR|\fIall\fR|\fIsome\fR|\fInone\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-d, \-\-depth\fR \fIINT\fR,\fIINT\fR,\fIINT\fR
.RS 4
ranges of depth distribution: min, max, and size of the bin
.RE
.PP
\fB\-\-debug\fR
.RS 4
produce verbose per\-site and per\-sample output
.RE
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-E, \-\-exons\fR \fIfile\&.gz\fR
.RS 4
tab\-delimited file with exons for indel frameshifts statistics\&. The columns of the file are CHR, FROM, TO, with 1\-based, inclusive, positions\&. The file is BGZF\-compressed and indexed with tabix
.RE
.sp
.if n \{\
.RS 4
.\}
.nf
    tabix \-s1 \-b2 \-e3 file\&.gz
.fi
.if n \{\
.RE
.\}
.PP
\fB\-f, \-\-apply\-filters\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-F, \-\-fasta\-ref\fR \fIref\&.fa\fR
.RS 4
faidx indexed reference sequence file to determine INDEL context
.RE
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include only sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-I, \-\-split\-by\-ID\fR
.RS 4
collect stats separately for sites which have the ID column set ("known sites") or which do not have the ID column set ("novel sites")\&.
.RE
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-u, \-\-user\-tstv\fR \fI<TAG[:min:max:n]>\fR
.RS 4
collect Ts/Tv stats for any tag using the given binning [0:1:100]
.RE
.PP
\fB\-v, \-\-verbose\fR
.RS 4
produce verbose per\-site and per\-sample output
.RE
.SS "bcftools view [\fIOPTIONS\fR] \fIfile\&.vcf\&.gz\fR [\fIREGION\fR [\&...]]"
.sp
View, subset and filter VCF or BCF files by position and filtering expression\&. Convert between VCF and BCF\&. Former \fBbcftools subset\fR\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBOutput options\fR
.RS 4
.PP
\fB\-G, \-\-drop\-genotypes\fR
.RS 4
drop individual genotype information (after subsetting if
\fB\-s\fR
option is set)
.RE
.PP
\fB\-h, \-\-header\-only\fR
.RS 4
output the VCF header only
.RE
.PP
\fB\-H, \-\-no\-header\fR
.RS 4
suppress the header in VCF output
.RE
.PP
\fB\-l, \-\-compression\-level\fR [\fI0\-9\fR]
.RS 4
compression level\&. 0 stands for uncompressed, 1 for best speed and 9 for best compression\&.
.RE
.PP
\fB\-\-no\-version\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-O, \-\-output\-type\fR \fIb\fR|\fIu\fR|\fIz\fR|\fIv\fR
.RS 4
see
\fBCommon Options\fR
.RE
.sp
\fB\-o, \-\-output\-file\fR \fIFILE\fR: output file name\&. If not present, the default is to print to standard output (stdout)\&.
.PP
\fB\-r, \-\-regions\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-R, \-\-regions\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-t, \-\-targets\fR \fIchr\fR|\fIchr:pos\fR|\fIchr:from\-to\fR|\fIchr:from\-\fR[,\&...]
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-T, \-\-targets\-file\fR \fIfile\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-\-threads\fR \fIINT\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBSubset options:\fR
.RS 4
.PP
\fB\-a, \-\-trim\-alt\-alleles\fR
.RS 4
trim alternate alleles not seen in subset\&. Type A, G and R INFO and FORMAT fields will also be trimmed
.RE
.PP
\fB\-\-force\-samples\fR
.RS 4
only warn about unknown subset samples
.RE
.PP
\fB\-I, \-\-no\-update\fR
.RS 4
do not (re)calculate INFO fields for the subset (currently INFO/AC and INFO/AN)
.RE
.PP
\fB\-s, \-\-samples\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-S, \-\-samples\-file\fR \fIFILE\fR
.RS 4
see
\fBCommon Options\fR
.RE
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBFilter options:\fR
.RS 4
.sp
Note that filter options below dealing with counting the number of alleles will, for speed, first check for the values of AC and AN in the INFO column to avoid parsing all the genotype (FORMAT/GT) fields in the VCF\&. This means that a filter like \fI\-\-min\-af 0\&.1\fR will be based \(oqAC/AN\(cq where AC and AN come from either INFO/AC and INFO/AN if available or FORMAT/GT if not\&. It will not filter on another field like INFO/AF\&. The \fI\-\-include\fR and \fI\-\-exclude\fR filter expressions should instead be used to explicitly filter based on fields in the INFO column, e\&.g\&. \fI\-\-exclude AF<0\&.1\fR\&.
.PP
\fB\-c, \-\-min\-ac\fR \fIINT\fR[\fI:nref\fR|\fI:alt1\fR|\fI:minor\fR|\fI:major\fR|:\*(Aqnonmajor\*(Aq]
.RS 4
minimum allele count (INFO/AC) of sites to be printed\&. Specifying the type of allele is optional and can be set to non\-reference (\fInref\fR, the default), 1st alternate (\fIalt1\fR), the least frequent (\fIminor\fR), the most frequent (\fImajor\fR) or sum of all but the most frequent (\fInonmajor\fR) alleles\&.
.RE
.PP
\fB\-C, \-\-max\-ac\fR \fIINT\fR[\fI:nref\fR|\fI:alt1\fR|\fI:minor\fR|:\*(Aqmajor\*(Aq|:\*(Aqnonmajor\*(Aq]
.RS 4
maximum allele count (INFO/AC) of sites to be printed\&. Specifying the type of allele is optional and can be set to non\-reference (\fInref\fR, the default), 1st alternate (\fIalt1\fR), the least frequent (\fIminor\fR), the most frequent (\fImajor\fR) or sum of all but the most frequent (\fInonmajor\fR) alleles\&.
.RE
.PP
\fB\-e, \-\-exclude\fR \fIEXPRESSION\fR
.RS 4
exclude sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-f, \-\-apply\-filters\fR \fILIST\fR
.RS 4
see
\fBCommon Options\fR
.RE
.PP
\fB\-g, \-\-genotype\fR [^][\fIhom\fR|\fIhet\fR|\fImiss\fR]
.RS 4
include only sites with one or more homozygous (\fIhom\fR), heterozygous (\fIhet\fR) or missing (\fImiss\fR) genotypes\&. When prefixed with
\fI^\fR, the logic is reversed; thus
\fI^het\fR
excludes sites with heterozygous genotypes\&.
.RE
.PP
\fB\-i, \-\-include\fR \fIEXPRESSION\fR
.RS 4
include sites for which
\fIEXPRESSION\fR
is true\&. For valid expressions see
\fBEXPRESSIONS\fR\&.
.RE
.PP
\fB\-k, \-\-known\fR
.RS 4
print known sites only (ID column is not "\&.")
.RE
.PP
\fB\-m, \-\-min\-alleles\fR \fIINT\fR
.RS 4
print sites with at least
\fIINT\fR
alleles listed in REF and ALT columns
.RE
.PP
\fB\-M, \-\-max\-alleles\fR \fIINT\fR
.RS 4
print sites with at most
\fIINT\fR
alleles listed in REF and ALT columns\&. Use
\fB\-m2 \-M2 \-v snps\fR
to only view biallelic SNPs\&.
.RE
.PP
\fB\-n, \-\-novel\fR
.RS 4
print novel sites only (ID column is "\&.")
.RE
.PP
\fB\-p, \-\-phased\fR
.RS 4
print sites where all samples are phased\&. Haploid genotypes are considered phased\&. Missing genotypes considered unphased unless the phased bit is set\&.
.RE
.PP
\fB\-P, \-\-exclude\-phased\fR
.RS 4
exclude sites where all samples are phased
.RE
.PP
\fB\-q, \-\-min\-af\fR \fIFLOAT\fR[\fI:nref\fR|\fI:alt1\fR|\fI:minor\fR|\fI:major\fR|\fI:nonmajor\fR]
.RS 4
minimum allele frequency (INFO/AC / INFO/AN) of sites to be printed\&. Specifying the type of allele is optional and can be set to non\-reference (\fInref\fR, the default), 1st alternate (\fIalt1\fR), the least frequent (\fIminor\fR), the most frequent (\fImajor\fR) or sum of all but the most frequent (\fInonmajor\fR) alleles\&.
.RE
.PP
\fB\-Q, \-\-max\-af\fR \fIFLOAT\fR[\fI:nref\fR|\fI:alt1\fR|\fI:minor\fR|\fI:major\fR|\fI:nonmajor\fR]
.RS 4
maximum allele frequency (INFO/AC / INFO/AN) of sites to be printed\&. Specifying the type of allele is optional and can be set to non\-reference (\fInref\fR, the default), 1st alternate (\fIalt1\fR), the least frequent (\fIminor\fR), the most frequent (\fImajor\fR) or sum of all but the most frequent (\fInonmajor\fR) alleles\&.
.RE
.PP
\fB\-u, \-\-uncalled\fR
.RS 4
print sites without a called genotype
.RE
.PP
\fB\-U, \-\-exclude\-uncalled\fR
.RS 4
exclude sites without a called genotype
.RE
.PP
\fB\-v, \-\-types\fR \fIsnps\fR|\fIindels\fR|\fImnps\fR|\fIother\fR
.RS 4
comma\-separated list of variant types to select\&. Site is selected if any of the ALT alleles is of the type requested\&. Types are determined by comparing the REF and ALT alleles in the VCF record not INFO tags like INFO/INDEL or INFO/VT\&. Use
\fB\-\-include\fR
to select based on INFO tags\&.
.RE
.PP
\fB\-V, \-\-exclude\-types\fR \fIsnps\fR|\fIindels\fR|\fImnps\fR|\fIref\fR|\fIbnd\fR|\fIother\fR
.RS 4
comma\-separated list of variant types to exclude\&. Site is excluded if any of the ALT alleles is of the type requested\&. Types are determined by comparing the REF and ALT alleles in the VCF record not INFO tags like INFO/INDEL or INFO/VT\&. Use
\fB\-\-exclude\fR
to exclude based on INFO tags\&.
.RE
.PP
\fB\-x, \-\-private\fR
.RS 4
print sites where only the subset samples carry an non\-reference allele\&. Requires
\fB\-\-samples\fR
or
\fB\-\-samples\-file\fR\&.
.RE
.PP
\fB\-X, \-\-exclude\-private\fR
.RS 4
exclude sites where only the subset samples carry an non\-reference allele
.RE
.RE
.SS "bcftools help [\fICOMMAND\fR] | bcftools \-\-help [\fICOMMAND\fR]"
.sp
Display a brief usage message listing the bcftools commands available\&. If the name of a command is also given, e\&.g\&., bcftools help view, the detailed usage message for that particular command is displayed\&.
.SS "bcftools [\fI\-\-version\fR|\fI\-v\fR]"
.sp
Display the version numbers and copyright information for bcftools and the important libraries used by bcftools\&.
.SS "bcftools [\fI\-\-version\-only\fR]"
.sp
Display the full bcftools version number in a machine\-readable format\&.
.SH "EXPRESSIONS"
.sp
These filtering expressions are accepted by most of the commands\&.
.PP
\fBValid expressions may contain:\fR
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
numerical constants, string constants, file names
.sp
.if n \{\
.RS 4
.\}
.nf
1, 1\&.0, 1e\-4
"String"
@file_name
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
arithmetic operators
.sp
.if n \{\
.RS 4
.\}
.nf
+,*,\-,/
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
comparison operators
.sp
.if n \{\
.RS 4
.\}
.nf
== (same as =), >, >=, <=, <, !=
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
regex operators "~" and its negation "!~"\&. The expressions are case sensitive unless "/i" is added\&.
.sp
.if n \{\
.RS 4
.\}
.nf
INFO/HAYSTACK ~ "needle"
INFO/HAYSTACK ~ "NEEDless/i"
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
parentheses
.sp
.if n \{\
.RS 4
.\}
.nf
(, )
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
logical operators
.sp
.if n \{\
.RS 4
.\}
.nf
&& (same as &), ||,  |
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
INFO tags, FORMAT tags, column names
.sp
.if n \{\
.RS 4
.\}
.nf
INFO/DP or DP
FORMAT/DV, FMT/DV, or DV
FILTER, QUAL, ID, POS, REF, ALT[0]
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
1 (or 0) to test the presence (or absence) of a flag
.sp
.if n \{\
.RS 4
.\}
.nf
FlagA=1 && FlagB=0
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
"\&." to test missing values
.sp
.if n \{\
.RS 4
.\}
.nf
DP="\&.", DP!="\&.", ALT="\&."
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
missing genotypes can be matched regardless of phase and ploidy ("\&.|\&.", "\&./\&.", "\&.") using these expressions
.sp
.if n \{\
.RS 4
.\}
.nf
GT~"\e\&.", GT!~"\e\&."
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
missing genotypes can be matched including the phase and ploidy ("\&.|\&.", "\&./\&.", "\&.") using these expressions
.sp
.if n \{\
.RS 4
.\}
.nf
GT="\&.|\&.", GT="\&./\&.", GT="\&."
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
sample genotype: reference (haploid or diploid), alternate (hom or het, haploid or diploid), missing genotype, homozygous, heterozygous, haploid, ref\-ref hom, alt\-alt hom, ref\-alt het, alt\-alt het, haploid ref, haploid alt (case\-insensitive)
.sp
.if n \{\
.RS 4
.\}
.nf
GT="ref"
GT="alt"
GT="mis"
GT="hom"
GT="het"
GT="hap"
GT="RR"
GT="AA"
GT="RA" or GT="AR"
GT="Aa" or GT="aA"
GT="R"
GT="A"
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
TYPE for variant type in REF,ALT columns (indel,snp,mnp,ref,bnd,other)\&. Use the regex operator "\e~" to require at least one allele of the given type or the equal sign "=" to require that all alleles are of the given type\&. Compare
.sp
.if n \{\
.RS 4
.\}
.nf
TYPE="snp"
TYPE~"snp"
TYPE!="snp"
TYPE!~"snp"
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
array subscripts (0\-based), "*" for any element, "\-" to indicate a range\&. Note that for querying FORMAT vectors, the colon ":" can be used to select a sample and an element of the vector, as shown in the examples below
.sp
.if n \{\
.RS 4
.\}
.nf
INFO/AF[0] > 0\&.3             \&.\&. first AF value bigger than 0\&.3
FORMAT/AD[0:0] > 30          \&.\&. first AD value of the first sample bigger than 30
FORMAT/AD[0:1]               \&.\&. first sample, second AD value
FORMAT/AD[1:0]               \&.\&. second sample, first AD value
DP4[*] == 0                  \&.\&. any DP4 value
FORMAT/DP[0]   > 30          \&.\&. DP of the first sample bigger than 30
FORMAT/DP[1\-3] > 10          \&.\&. samples 2\-4
FORMAT/DP[1\-]  < 7           \&.\&. all samples but the first
FORMAT/DP[0,2\-4] > 20        \&.\&. samples 1, 3\-5
FORMAT/AD[0:1]               \&.\&. first sample, second AD field
FORMAT/AD[0:*], AD[0:] or AD[0] \&.\&. first sample, any AD field
FORMAT/AD[*:1] or AD[:1]        \&.\&. any sample, second AD field
(DP4[0]+DP4[1])/(DP4[2]+DP4[3]) > 0\&.3
CSQ[*] ~ "missense_variant\&.*deleterious"
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
with many samples it can be more practical to provide a file with sample names, one sample name per line
.sp
.if n \{\
.RS 4
.\}
.nf
GT[@samples\&.txt]="het" & binom(AD)<0\&.01
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
function on FORMAT tags (over samples) and INFO tags (over vector fields)
.sp
.if n \{\
.RS 4
.\}
.nf
MAX, MIN, AVG, SUM, STRLEN, ABS, COUNT
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
two\-tailed binomial test\&. Note that for N=0 the test evaluates to a missing value and when FORMAT/GT is used to determine the vector indices, it evaluates to 1 for homozygous genotypes\&.
.sp
.if n \{\
.RS 4
.\}
.nf
binom(FMT/AD)                \&.\&. GT can be used to determine the correct index
binom(AD[0],AD[1])           \&.\&. or the fields can be given explicitly
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
variables calculated on the fly if not present: number of alternate alleles; number of samples; count of alternate alleles; minor allele count (similar to AC but is always smaller than 0\&.5); frequency of alternate alleles (AF=AC/AN); frequency of minor alleles (MAF=MAC/AN); number of alleles in called genotypes; number of samples with missing genotype; fraction of samples with missing genotype;
.sp
.if n \{\
.RS 4
.\}
.nf
N_ALT, N_SAMPLES, AC, MAC, AF, MAF, AN, N_MISSING, F_MISSING
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
the number (N_PASS) or fraction (F_PASS) of samples which pass the expression
.sp
.if n \{\
.RS 4
.\}
.nf
N_PASS(GQ>90 & GT!="mis") > 90
F_PASS(GQ>90 & GT!="mis") > 0\&.9
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
custom perl filtering\&. Note that this command is not compiled in by default, see the section
\fBOptional Compilation with Perl\fR
in the INSTALL file for help and misc/demo\-flt\&.pl for a working example\&. The demo defined the perl subroutine "severity" which can be invoked from the command line as follows:
.sp
.if n \{\
.RS 4
.\}
.nf
perl:path/to/script\&.pl; perl\&.severity(INFO/CSQ) > 3
.fi
.if n \{\
.RE
.\}
.RE
.PP
\fBNotes:\fR
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
String comparisons and regular expressions are case\-insensitive
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Variables and function names are case\-insensitive, but not tag names\&. For example, "qual" can be used instead of "QUAL", "strlen()" instead of "STRLEN()" , but not "dp" instead of "DP"\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
When querying multiple values, all elements are tested and the OR logic is used on the result\&. For example, when querying "TAG=1,2,3,4", it will be evaluated as follows:
.sp
.if n \{\
.RS 4
.\}
.nf
\-i \*(AqTAG[*]=1\*(Aq   \&.\&. true, the record will be printed
\-i \*(AqTAG[*]!=1\*(Aq  \&.\&. true
\-e \*(AqTAG[*]=1\*(Aq   \&.\&. false, the record will be discarded
\-e \*(AqTAG[*]!=1\*(Aq  \&.\&. false
\-i \*(AqTAG[0]=1\*(Aq   \&.\&. true
\-i \*(AqTAG[0]!=1\*(Aq  \&.\&. false
\-e \*(AqTAG[0]=1\*(Aq   \&.\&. false
\-e \*(AqTAG[0]!=1\*(Aq  \&.\&. true
.fi
.if n \{\
.RE
.\}
.RE
.sp
\fBExamples:\fR
.sp
.if n \{\
.RS 4
.\}
.nf
MIN(DV)>5
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
MIN(DV/DP)>0\&.3
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
MIN(DP)>10 & MIN(DV)>3
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
FMT/DP>10  & FMT/GQ>10 \&.\&. both conditions must be satisfied within one sample
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
FMT/DP>10 && FMT/GQ>10 \&.\&. the conditions can be satisfied in different samples
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
QUAL>10 |  FMT/GQ>10   \&.\&. true for sites with QUAL>10 or a sample with GQ>10, but selects only samples with GQ>10
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
QUAL>10 || FMT/GQ>10   \&.\&. true for sites with QUAL>10 or a sample with GQ>10, plus selects all samples at such sites
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
TYPE="snp" && QUAL>=10 && (DP4[2]+DP4[3] > 2)
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
COUNT(GT="hom")=0
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
MIN(DP)>35 && AVG(GQ)>50
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
ID=@file       \&.\&. selects lines with ID present in the file
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
ID!=@~/file    \&.\&. skip lines with ID present in the ~/file
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
MAF[0]<0\&.05    \&.\&. select rare variants at 5% cutoff
.fi
.if n \{\
.RE
.\}
.sp
.if n \{\
.RS 4
.\}
.nf
POS>=100   \&.\&. restrict your range query, e\&.g\&. 20:100\-200 to strictly sites with POS in that range\&.
.fi
.if n \{\
.RE
.\}
.sp
\fBShell expansion:\fR
.sp
Note that expressions must often be quoted because some characters have special meaning in the shell\&. An example of expression enclosed in single quotes which cause that the whole expression is passed to the program as intended:
.sp
.if n \{\
.RS 4
.\}
.nf
bcftools view \-i \*(Aq%ID!="\&." & MAF[0]<0\&.01\*(Aq
.fi
.if n \{\
.RE
.\}
.sp
Please refer to the documentation of your shell for details\&.
.SH "SCRIPTS AND OPTIONS"
.SS "plot\-vcfstats [\fIOPTIONS\fR] \fIfile\&.vchk\fR [\&...]"
.sp
Script for processing output of \fBbcftools stats\fR\&. It can merge results from multiple outputs (useful when running the stats for each chromosome separately), plots graphs and creates a PDF presentation\&.
.PP
\fB\-m, \-\-merge\fR
.RS 4
Merge vcfstats files to STDOUT, skip plotting\&.
.RE
.PP
\fB\-p, \-\-prefix\fR \fIDIR\fR
.RS 4
The output directory\&. This directory will be created if it does not exist\&.
.RE
.PP
\fB\-P, \-\-no\-PDF\fR
.RS 4
Skip the PDF creation step\&.
.RE
.PP
\fB\-r, \-\-rasterize\fR
.RS 4
Rasterize PDF images for faster rendering\&.
.RE
.PP
\fB\-s, \-\-sample\-names\fR
.RS 4
Use sample names for xticks rather than numeric IDs\&.
.RE
.PP
\fB\-t, \-\-title\fR \fISTRING\fR
.RS 4
Identify files by these titles in plots\&. The option can be given multiple times, for each ID in the
\fBbcftools stats\fR
output\&. If not present, the script will use abbreviated source file names for the titles\&.
.RE
.PP
\fB\-T, \-\-main\-title\fR \fISTRING\fR
.RS 4
Main title for the PDF\&.
.RE
.SH "PERFORMANCE"
.sp
HTSlib was designed with BCF format in mind\&. When parsing VCF files, all records are internally converted into BCF representation\&. Simple operations, like removing a single column from a VCF file, can be therefore done much faster with standard UNIX commands, such as \fBawk\fR or \fBcut\fR\&. Therefore it is recommended to use BCF as input/output format whenever possible to avoid large overhead of the VCF → BCF → VCF conversion\&.
.SH "BUGS"
.sp
Please report any bugs you encounter on the github website: http://github\&.com/samtools/bcftools
.SH "AUTHORS"
.sp
Heng Li from the Sanger Institute wrote the original C version of htslib, samtools and bcftools\&. Bob Handsaker from the Broad Institute implemented the BGZF library\&. Petr Danecek, Shane McCarthy and John Marshall are maintaining and further developing bcftools\&. Many other people contributed to the program and to the file format specifications, both directly and indirectly by providing patches, testing and reporting bugs\&. We thank them all\&.
.SH "RESOURCES"
.sp
BCFtools GitHub website: http://github\&.com/samtools/bcftools
.sp
Samtools GitHub website: http://github\&.com/samtools/samtools
.sp
HTSlib GitHub website: http://github\&.com/samtools/htslib
.sp
File format specifications: http://samtools\&.github\&.io/hts\-specs
.sp
BCFtools documentation: http://samtools\&.github\&.io/bcftools
.sp
BCFtools wiki page: https://github\&.com/samtools/bcftools/wiki
.SH "COPYING"
.sp
The MIT/Expat License or GPL License, see the LICENSE document for details\&. Copyright (c) Genome Research Ltd\&.

# python -m unittest tests.test_gene 
import unittest
from simulator.gene import Gene

class GeneSetup(unittest.TestCase):
    def setUp(self):
        self.simple_gene = Gene("testing_data/genes/basic_gene.json")
    
    def tearDown(self):
        self.simple_gene = None

class GeneCreationTests(unittest.TestCase): 
    def test_IO_exception(self):
        self.assertRaises(Gene("testing_data/genes/basic_gene_nonexist.json"))
    
    def test_bad_json_exception(self):
        self.assertRaises(Gene("testing_data/genes/impropper_format_gene.json"))

class GeneMethodTests(GeneSetup):
    def test_get_exons(self):
        self.assertEqual(self.simple_gene.get_exons(), 
                        [["ATTCCTCAGGACACAGAGCTTCCTCTCTCCCAGGAGCCATGAATATCCTGATGCTGACCTTCATTATCTGTGGGTTGCTAACTCGGGTGACCAAAG", 0, 96],
                        ["GTAGCTTTGAACCCCAAAAATGTTGGAAGAATAATGTAGGACATTGCAGAAGACGATGTTTAGATACTGAAAGGTACATACTTCTTTGTAGGAACAAGCTATCATGCTGCATTTCTATAATATCACATGAATATACTCGACGACCAGCATTTCCTGTGATTCACCTAGAGGATATAACATTGGATTATAGTGATGTGGACTCTTTTACTGGTTCCCCAGTATCTATGTTGAATGATCTGATAACATTTGACACAACTAAATTTGGAGAAACCATGACACCTGAGACCAATACTCCTGAGACTACTATGCCACCATCTGAGGCCACTACTCCCGAGACTACTATGCCACCATCTGAGACTGCTACTTCCGAGACTATGCCACCACCTTCTCAGACAGCTCTTACTCATAATTAATTAACATTTACTTCTGGTATGGAACAACTAGAAATACTGCTGGAAATAATATCCAAAGAGCTGATTCTACCAATCCAATTTCACCAGGAAAATTCCATCAGGGATTGGATGACCATGGGGATGGACATAATTGCTACTACCAACACAACAGCCAAG", 8333, 8902]])

    def test_get_introns(self):
        self.assertEqual(self.simple_gene.get_introns(), [["GTAATGGAACCCTATAAAGCAGAGATGATGACTAGGATGAGTTGTTGCCCTTGGGCTCCCCTGGTATCATGATGGGAAGAGAGGGAATCTGCAGGAAAAATCTGGGCCAACAAAGAGCAGCAGAATGCTCTTATTTTGGCAGCTCCATGCCCCTAGTCTCTGAGAATCTTTCTGTTAGGGGCATCTAGCAAGCTGGGATGTCCTCTGAGGCATTTCTCCAAAGACAAGAATTTCCTTAATGCTCTGAGCCACCCTATCTGTCTCTCTACATAACTATCCAATGTTAGTTCAGCCTCACTTCACTTCCATTTCGATTATTCTGTTGTATCTATTTCATTGTTGTGTCCTATTAGTTCTCCTACCATCTTGAATTCTTCTTTGCCCGGAGGGTACCTTCAGAGGGAGGCCCTCACTTTCATGTTCTTAGATATGGTGAACAAGTCCATTGACAGTTTGTAGATTCTGTAGCACTATCATATGGAAGAGACAATATATATGTTTGGGGTAGAAGTGGAAATAAGTGGAGTGAAGACAGGATAGACAGACTAGTGACCAATGGGGAGCTTCTAATTTTAGATGAATAGGAACAGTCTGTTTCCACTATTTAATAATGCTACTTTTGAAAATTGTTAACTTTTTATTAAAAAATAATACTTGCAATTGACTTATGTATCAAGCAATCGATGGATTTATAGGGTTTAAGGAAAAGAAAAATGTTTGTCTGTCCAAGAATACCAGTTCTTCAGTCTTCCCCTTCAGAATCAATCAATGTTACCAATTTCTTATATATCCTAGCAAATACAAATATATTTATATTTGCATGTGTATACCTTTTAGATTTTTAAAAAATGCAATTGCAAATGCACCATGTGAATTGTTCTGCAATGTACTAGCAATATATTAGAGACATCTTATCCATACATAAACCTAGTTCATTATTTTTAATCGATAAGTAAAACTTTGAGGAGGAGCAGATGAATTGCCTCACATTAATTACTCCGCTACTGATGAAAAATAGGTCTTTAATTATCAAAAACAATTCAGCAAGAAAAATTTGTAAACAAATGTATGTCTTTTCATTTATGACTGGACACGTGGACACACACACACACACACACACACACACAGTCAAACCACCTACCAGAAAAGCTGAACTATTCTTCTCTCCTATCACCAGTTGCAAGAGTGTCAGCTTCCCACACCCTCATCAGTCCTTTTTGTTTTTTCTACTACATTCAGTTTTCTACTACATTCAGTTTTACAGTCTAATATGTGAAAATGATGTCCTGATGTTTGAATTCATGACACTTTAGTTATAAATGAGTTTGAACATCCAGTCCATTAGATTTCTAAACTTTCTTAATTATCTTTATATACTAAGAAATTTGGCTTTTGTTAAATTTGGAGGTGTTATATGTTGCCTAGAAAGATGCTATTCATGTCTATTAAATGGTTATAACTGTGCCTATGATCTGTTATGTCTTGATTCACATGTTGATGTAATGTGAGTTACAGAATTAATATCTACATTCATTTCTGATTATAAACTGCTGTATTTGTTGAAAATTTGGAAATTTTGAAATTGTAAAGAAGTAAAAAAATTGTAAAGAAGTTAAAAGAGACAAAATATTTTTGATCTATTGTTCTTCCTCAGTTTTCTTATTTGAATAAAAATGTATAGCATACTTATAAATTTTCTATTATACTATTAGTATTTTCCCATTTACTATTTTCAAAAACTGTATTTCCAATGACTGTATAAATTTTATAGAATGGATACTGTTTAAATTACTTAGCCAAATTGTTTTTGCATAAATAAGTGCATTTACATTTTATAGACAAGGATGGCTAGTATAACCTTTCTTATACATAAATCATTCAGCATAAAATTCCTGGAGATGTACTTTTTTCTGTCTGCTTCATGTGTTATCAATTTTTGAATACTTGCCAAGTCCTAAAAATGAAATATTATATATAAATATTTAATTTTTATTTATGTCTGTGAGTAATGGGGAAGTCGAACTTCAAATACATGCTTAATGTATATTTAACTTTTCTACAAATTGTCTATGTCTCTCTTTCTCTTTTATTTTGGAGAGGTAGTTTTCATTTCTTTTGATTTAGAGATTTTCATTTTTGTGTTCTCTTATAGGTTTTGTTTTGAAATTTAGCTATTTAGTCTCTCTGGGCTTTATATTATGTGTTTTCAAGTGAGATAGCACCTGATGGCTTGTGAAGCAACTTTTTACCAAGCCAAGCTATCAGTGGACTGGTATCCATAGATATATTTTAAGTTGATGCTAGCTGATTATATATCTGGTATGTTTTAGAAAGAACTCCACACATGGGATAATGTTTTGGCTAGATGGCTCCCCTACTTAGAAACATACAATTGCTAGTCATATTTCTAATTTTAGGATTTCGAGATACTGGTGATGAAGATCACATGTCCTAACAACATAATAGTTCCAGACTGAAGTTCTTTGAAAAAAATGACTGTTGTCACTTTAGAAAAAAAAAATTATGAATTATTCCCAATTGCCATCATTCTACTGCTAAAACCAAATTCTTGGAATTATCTATGATTTTTCTATATCCTATGACACTCATATCTATCAGGAAGTCTATTACATCTGCCTGCAAATTATATCCAGAATGCAATTATTCTCGCCACCTCCATTGCTGCCACTCTGATTCTAGTCACCATCATCTCTCACCTGTGTTATTGCCATAGCTTCCTCATGAGATCTGTCCTTCTGCTCTTCCCTGCCACCATCTTGTGAAGACACATAGTGCATGATCCGCTTACACTGGAAGTCAGATCATGTACTTTTGCTCAAAACTCTGCTATGGCCCCCTCTATACTCAGAGCGGTAACAAGAGTCCATACAGTGGCTCACCTGGCCCTGCAGGATCTGGCCCTTATGACCTCTCTCACCTCATCTCCTACTATTATAGTCCTTGTTCACTCCACTACAGCCACACAAGCCCCAGTGCTCTTCCCCAAACATATCAGACTTACTCAACCCATAGAGCTTTGTTTGTTTCCTCTGCCTAGAATGTACTTGCCTCAGATACTGGTGTGACTAATTCCTTTACCTCCTTCAAGCTGTTTAATCATCACCTTGTTACACAGGCTTGTGCAACTCCTGTTTATGAATCTTCTATTACCCTTAAATCTATTCTCCCTTCTTTCTGCAAACCATTTGTCACCTTTTCATCTACAAAATAATGTACTTTTTTATTAAGGTAAAATATACATTTAAAAATTACCATCCTTACCATGTTTTTACCATATTTTTATGTATACCTGATGGCTGTTTGTATGTCTTCTGTTGAGAAATGTCTATTCAAATCTTTTGCCTGTTTTAAAATCAGATTATTTGTTTTTGTTTGCTATGGAGTTTTTTGAGCTCCTTATATTAATATACTTTTTGTTGTTAATTCCTCGTCAGATGGATAGCTTGCAAATATTTTCTCCTACTCTGTGGGCTACATCTTCACTTTGTTGATTATTTCCTTTGCTGTGCACAAGCTTTTTAGTTTGATGTAATCCTAATTGCCTATTTTTGCTTTGGTTGCCCGTGCTTTTGAGGTCTTACCCAAGAAATCTTTGCCAAGACCAACGTCCTGAAGTGTTTCCCTAATGTTTTTTTCAGGTAGTTCCATAGTTTCAGGTCTTAGATTTAAGTCTGTAAAACCATACAGTCTAGCAGGGAGTGCATTTACTTTTTATTATCTGTCTCCCTCTGCTAGAAAGTCAGCTCCATGTGATTTTTGTCTGTTTAGTTCACAGATGTACCTCAAGGGCCCAGGATAGTGCCTGTGCCATAGTAGGGGCCCAAAACTTTGATGACTGTGTGACTATAGCCTAATTTAAGAATGGAGGGGATAATTTAAAAGCAGTAGGAAGGAATGTAAGTGAGAAACAATTTTGAAGAATAATTGACAGAACAAGGCGATTCAAAGACAAAGGAGAAGAAGAGAGCCAAGATGACATATTTCAAGTATGGATAATGCTGGAGGAAAAAAATTAAGATATAAATCTTTGTAGATGTGAGGAACGAAGAAGCAAGGTTAGAGTCTGTCTTGCACAAAAGAAGTGGAAGGTCTAGACTTGAAACTTATAGAAAATTCCACGAAGTACAAAGTAAAATCGAGCCAGTAAAATAACAAAGATAGAATAAATGACTCTAGAGGAGTGAAGGTAGAATAAATAATTGGTGAAGCTGGACTAGAGCCAACATTTCCCAGAGGATAAAATATAAACCAAATTATTGTGAGCCTAATATATACATACATACATACATCTATATATGTTTTATATATATTATCACATTAAGTTCAAATAAGGTTGTTTAGAAAATTACTTGCTCTTCTGCACATATACCAGGCTTCCTCCTCCATAGAGCCTTATCTCTAGCTGCTTCCTCTGCCTAGAATACACTTATCTAGGTACTCCTTGGGCAATTGTCTTGAGAAAGATGATCATGCCGTTTACTGCTTGATAAATGAACATACAATGCAGCACACTAGTTTCCCTTTAGATTTATATCCTCACCCCTCAAATGAGTAGTCACACTGCTTGGAAATCCTACTGCATTTCTCTTGTAAATGAACCTTCCTTCTTTTTTTTTTTTTTTTGAGACAGAGTCTTTCTCTGTCACCAGGCTGGACTGCAGTGGCCCAATCTCGGCTCATTGCAACCGCCAACTCCCTGGTTCAAGTGATTCTCCTGCCTCAGCCTCCCGAGTAGCTGGGATCACAGGCATGTGCCACCACATCCAGCTAATTTTTATATTTTTAGTAGAGACAGGTTTTCACCAGGTTGGCCAGGATGGTCTCGATCTCCTGACCCTGTGATCCACCCTCCTCGGCTTCCCAAAGTGCTGGGATTACAGGTTTGTACCACCACACCCAGCCATCTTCCCTCTTTTTTAGACAACTATTTTGTCCTGACCTTTATTTGTCTTTTATTTTCCTGCTCCTCTCCTCTACATGGCTCTCCCCCTCAGTTTATCCCATGCCCCATTTATTTAAACAATTCAAATAGGAAGTTTTCACTCATTTCCTCTGTCCCCTTTGCCATAAATGGAGAAACGTGTCTTCTCCATCTAAAGATCAGTCTGCTCTGTGTGAATTTGTGACTATGCCCTTCTGTCATCTCATCACCCTATTCTATATTAATCTCTCCTTTTCTGCTTTTTTTTTTTTTTTTTTGAGATGGAGTCTTGCTCTTGTTGCCCAGGCTGGAATGCAGTGGCACAATCTTGGCTTACTGCAACCTTCGCCTCCCAGGTTCAAGTGATTCTCCTGCCTCAGCATCCTGAGTAGCTGGGACTACAGGTGCTCGCCACCATGCCCAGCTAATTTTTGTATTTTTTAGTAGAGACAGGGTTTCACCATGGCCAGGCTGGTCTCGAACTCCTGAACTCAGGTGATCTGCCCGCCTCGATCTCCCAAAGTGCTGGGATTACATGTGTGAGCCACTGCGCCCAGACTGCTTGTCTCTTTTCTCATTGCTTGCAAGCACCATTTGGTATTTCTCGTTCTTCAAAACAAACCTGAAAGCTTTCCCTTAACCTTACATTGCTCTCTAACAAGTTATTTATTTCTCTGCTTTTCTTTGGATCTAAACTTCTTAAGAGTTTCATCTACAGGTCCTGCATTCACTTCTCTCTCATTCACATTTTGACCAACTGCAATTTGGTTTCTTTTTTCATACCACTCGGAAGCTGCTCTCCTCAGTATGAAGTTACCTTCATACTACTAAAAGCATGGACATTTTCCTGCCTTCATCATTTTTTTTTAACCTCTCAGCAGTATTTGACTACAAAATGACCACTCTGTCCTTTAAGAAACAGTCTCCTCTCCTGCTTAATGTAGTCACATCTGATACAACTTTCCCCATAACCTTTTATGCATTTTCTGTTTTCATGCATATCAGCCCAACTTGCAATTGTCAGTATCTCCAGTCTTTCAACAACTGCTTGTGAAATACCCCTGTACAGGGCAATCCAGAAATGCCAGAAAATTATCAGCTGTCTCTGGATCATCTGTCAACTATGGGGGAAGCTGGATAAATAGTCCAGGTCCTTTGAGCCTCATGTAGAATAACTTTGAGGCTTGGTAATATTTTTTTTTTCCTGTGGTAATTCCCTTATTTGCAGTTCAAGGCTATTATGGGAAGAAAACATAAATGGATGTTAGTTCTTCAAGGTTTTTACTGTAACTGTGCACCCTTTCATTCTTCAAGGTTTTTCTGTAACACTGCACCTTCAGGACCTGATGCCCAATTAAACATTTTTTTAAGTTTTTTGGTTTTTTTTTAATAAAAACTAAATGCTATTTTTTCTTCTACTTTTAGTTGATGTGTAATAATTGTTCATATTTAGAAGATGCAGAGTGATATTTTGATACATGTATACAATGTGTAATGATCAAATCAGGGTAATTAGCATATCTATCACCTCAAACATTTGTCATTTTTTTATATTGGGAACATTCAGAATCGTCTCTTCTAGCTATTTGAAAATATACAGTAAATGATTGTTAACTACCGTCACCCTACAGTGCTATAGAACAGTGGACCCCTTTTGGCACCAGGGACCAGTTTTGTGGAAGACAGTTTTTTCGACGAGGTGAAGGTGGTGGTGGGGATGGTTTCAGGATGAAACTGTTCCACCTCAGGTCATCAGGCATTAGAGTCTCACAAGGAACACACATCCTAGATCCCTCACATGCACAGTTCACAATAGGGTTCATGCTCCTATGAGACTCTAATGCCTTGGCTGATCTGACAAGAGATGGAGCTCAGGTGGTGATGCTTGCACACCTGCTGTTCACCTTTTGCTGTGCAGCCTGGTTCCTAACAGGCCATGGACCAGTACCCATTGGCTGCCCAGGGGTTGGGGACCCCTGCTATAGGATGCTGGAACTTTTTCCTCCTATCTAGGTGTAATTTTCTATCTGTTAACCAACCTCTCTCTATCCTCCTTTCCCTTCCCAGCCTCTAGTAATCATTATTCTACAGTCTACTTCTATGAACTCAACTTTTTTAGCTCCTGCTTATGAATGAAAACATGTGGTATTTATCTTTTTGTGTCTATTTCACATAACGGAATGTAACATGTCCCCCAGGCTCATCCATGAGTCTGAGGCTTATTTGTAGCCTGGCTGCTGGGCTTCCCTGTGGGATTGTCCTCTGAGCAAACAGAACACAGCCATCCTGCTGGCCAGCAGTTGATAGATGATCTCATGATAATAACAGGTTATAACTCACCTTTTCTTGGATTTCTTGCTTTCCTGATTTCTACATTTCTCCACTGATTTTTTTTAAGGAGGAATTGTCTCTCAACTAAACTATTATATTCAAATCTTTGCTGGAGCTCTGCTCTGCTGGGGGTCTGCTTTAAGACTCTAGAGTCTTATTCTCCTGTTTTGATCTGACTTATCTTATTGGTCCTTTTAAGTCGTTTCCTCTTATCTGATCTCTTATCTCTTAATATTGAAACTCACTAGAATTTAATTCTAGTCCTCTTTTTTTCTCATATTATTCCAACCCACCATGGTTTACCAATTTCTGTACTTTAAATGCTATCCATAAGCAATCACATTTATTGATTTGCATATGTCGAACCAACCTTGCATTCCAAGGATAAAGGCTACTTGATCGTAGTGGATAAGCTTTTTGATGTGCTGCTGGATTCAGTTTGCTACTATTTTGTTCAGGATTTTTGCACTGATGTTCATCAAGGATACTGGCCTGAAATTTTTTTTTTCTTGTGTCTCTGCTAGGTTTTGGTCTCAGGATGATGCTGGCCTCATAGAATAAGTTAAAGCGGAGTCCTGCCTTCTCAATTTTGGGTGAATAGTTTCAGTAGGAATGATACCAGCTCTTCTTTGTATATCTGGTAGAATTCAGCTGTGAATCCATCTGGTCCTGGGCTTTTCATTTTCATCCTTTCTTTCTAGGTTTCGTATCAGTCTCAGTATGCTCTCTCTCTCTCCGTCCCTCTCTTTTTCTACATTTCTCCTTTTCTCCATACAACTTCTTTGATGGCACATAGCACAATTTTAATATACACTTTTTGTTCTCCTGTTTGTCTCTTACAATGGCTTTTTGTATTTGACATCATATTAGTCTAGATGTCAGTCAGTGTAAATTTTTGAATGAATGAAAAGTTGTTATGTTGATGCCAGAGTTAAAAATTTGACCTATATTTTATTCTCTACAG",97,8332]])

    def test_get_upstream_utr(self):
        self.assertTrue(self.simple_gene.get_upstream_utr())

    def test_get_downstream_utr(self):
        self.assertTrue(self.simple_gene.get_downstream_utr())

    def test_get_promoter(self):
        self.assertTrue(self.simple_gene.get_promoter())

    def test_get_enhancer(self):
        self.assertTrue(self.simple_gene.get_enhancer())


if __name__ == '__main__':
    unittest.main()